(this["webpackJsonpui-ngx"]=this["webpackJsonpui-ngx"]||[]).push([[30],{671:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return w}));var c,a=n(42),o=n(83),r=n(134),i=n(354),l=n(674),s=n.n(l),d=n(673),u=n.n(d),b=n(43),j=n(36),m=n(47),O=n(173),p=n(155),f=n(37),x=n(672),h=n(106),g=n(251),v=n(104),T=n(0),C=n(1);!function(e){e.BY_TITLE="name",e.BY_CREATED_TIME="createdTime"}(c||(c={}));var S=[new j.e(c.BY_TITLE,"regTemp.sortBy.name"),new j.e(c.BY_CREATED_TIME,"regTemp.sortBy.createdTime")];function w(e){var t=e.sortProp,n=e.onSortChange,c=e.textSearch,l=e.onSearchChange,d=e.deleteDisabled,j=e.deleteTitle,w=e.addTitle,k=e.selectTitle,y=e.showSelectBtn,E=void 0!==y&&y,D=e.selectMode,A=void 0!==D&&D,M=e.authControl,I=void 0===M?"GENERAL":M,N=e.menus||S,R=Object(v.b)(),B=Object(v.a)(),_="GENERAL"===I?B:!R,L=Object(b.c)(m.a),P={add:!E||!A,delete:(!E||A)&&e.onDelete,select:E&&!A,selectAll:E&&A&&e.viewMode===x.a.CARD,cancel:E&&A};return Object(C.jsxs)(a.a,{sx:{mb:2,display:"flex",justifyContent:"space-between",height:36},children:[A&&Object(C.jsxs)(a.a,{className:"flex-start",children:[Object(C.jsx)(o.a,{fontSize:16,color:g.c,children:e.selectedCount}),Object(C.jsx)(o.a,{sx:{ml:1},children:Object(f.b)("common.selected")})]}),!A&&Object(C.jsxs)(a.a,{className:"flex-start",children:[void 0!==e.viewMode&&Object(C.jsx)(x.b,{items:x.c,mode:e.viewMode,onChange:e.onViewModeChange}),L?null:Object(C.jsx)(p.a,{title:"regTemp.sortBy."+t,selected:t,menus:N,onMenuClick:n}),Object(C.jsx)(O.a,{sx:{ml:L?0:2,bgcolor:"#fff"},value:c,onChange:l})]}),_&&Object(C.jsx)(T.Fragment,{children:L?Object(C.jsxs)(a.a,{children:[Object(C.jsx)(i.a,{onClick:e.onAdd,size:"medium",edge:"start",color:"primary","aria-label":"open drawer",sx:{mr:1},children:Object(C.jsx)(u.a,{})}),Object(C.jsx)(i.a,{onClick:e.onDelete,disabled:d,size:"medium",edge:"start",color:"error","aria-label":"open drawer",children:Object(C.jsx)(s.a,{})})]}):Object(C.jsxs)(a.a,{children:[P.add&&Object(C.jsx)(r.a,{onClick:e.onAdd,variant:"contained",children:Object(f.b)(w)}),P.cancel&&Object(C.jsx)(r.a,{onClick:function(){e.selectAll(!1),e.setSelectMode(!1)},variant:"outlined",children:Object(f.b)("common.cancel")}),P.selectAll&&Object(C.jsx)(h.a,{sx:{ml:2},onClick:function(){e.selectAll&&e.selectAll(!0)},children:Object(f.b)("common.selectAll")}),P.select&&Object(C.jsx)(h.a,{sx:{ml:2},onClick:function(){var t;void 0!==t?e.setSelectMode(t):e.setSelectMode(!A)},children:Object(f.b)(k)}),P.delete&&Object(C.jsx)(r.a,{onClick:e.onDelete,disabled:d,sx:{ml:2},variant:void 0!==e.viewMode?"contained":"outlined",children:Object(f.b)(j)})]})})]})}},672:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return O}));var c,a=n(5),o=n(7),r=n(134),i=n(64),l=n(689),s=n(995),d=n(171),u=n(51),b=n(1),j=Object(o.a)(r.a)((function(e){var t=e.theme;return{height:36,borderColor:t.palette.action.disabled,"&:hover":{borderColor:t.palette.action.disabled},"&.checked":{backgroundColor:Object(i.a)(t.palette.primary.main,.32)},"&.checked:hover":{backgroundColor:Object(i.a)(t.palette.primary.main,.32)}}}));!function(e){e[e.LIST=0]="LIST",e[e.CARD=1]="CARD"}(c||(c={}));var m=[{icon:"ic_viewmodule",value:c.CARD,label:"common.cardView"},{icon:"ic_viewheadline",value:c.LIST,label:"common.listView"}];function O(e){var t=e.mode,n=e.onChange,c=e.items,o=void 0===c?[]:c,r=e.sx,i=void 0===r?{}:r,m=Object(d.a)().t;return Object(b.jsx)(l.a,{sx:Object(a.a)({mr:2},i),children:o.map((function(e){return Object(b.jsx)(s.a,{title:m(e.label),children:Object(b.jsx)(j,{size:"small",onClick:function(){var c;(c=e.value)!==t&&n(c)},className:t===e.value?"checked":"",sx:{px:1},children:Object(b.jsx)(u.a,{color:"rgba(0, 0, 0, 0.54)",mr:0,icon:e.icon})})},e.label)}))})}},679:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var c=n(5),a=n(42),o=n(64),r=n(83),i=n(1);function l(e){var t=e.size,n=void 0===t?"medium":t;return Object(i.jsx)(a.a,{sx:Object(c.a)({userSelect:"none",borderRadius:1.5,height:"small"===n?24:32,fontSize:14,display:"inline-flex",alignItems:"center",lineHeight:"small"===n?"24px":"32px",whiteSpace:"nowrap",px:"small"===n?1:1.5,bgcolor:Object(o.a)(e.color,.1)},e.sx),children:Object(i.jsx)("span",{className:"custom-chip-inner",style:{whiteSpace:"nowrap",color:e.color},children:Object(i.jsx)(r.a,{className:"line-clamp",style:e.innerStyle,children:e.label})})})}},684:function(e,t,n){"use strict";var c=n(7),a=n(740),o=Object(c.a)(a.a)((function(){return{cursor:"pointer"}}));t.a=o},783:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var c,a=n(13),o=n(14),r=n(18),i=n(30),l=n(31),s=n(17),d=n(12),u=n(107);!function(e){e.INVALID="invalid",e.OCCUPIED_BY_TEMPLATE="occupiedByTemplate",e.OCCUPIED_BY_TENANT="occupiedByTenant"}(c||(c={}));var b=function(e){Object(i.a)(n,e);var t=Object(l.a)(n);function n(){var e,c,a,i,l,u,b,j,m;Object(o.a)(this,n);for(var O=arguments.length,p=new Array(O),f=0;f<O;f++)p[f]=arguments[f];return(m=t.call.apply(t,[this].concat(p))).createTemp=function(t){return Object(s.a)((e=Object(r.a)(m),Object(d.a)(n.prototype)),"post",e).call(e,"/api/registerTemplate/create",t)},m.getTemplates=function(e){return Object(s.a)((c=Object(r.a)(m),Object(d.a)(n.prototype)),"get",c).call(c,"/api/registerTemplates",{params:e})},m.getAgentDownloadUrl=function(){return Object(s.a)((a=Object(r.a)(m),Object(d.a)(n.prototype)),"get",a).call(a,"/api/agentPackage?pkgName=com.vantron.mdm")},m.validateSnList=function(e){return Object(s.a)((i=Object(r.a)(m),Object(d.a)(n.prototype)),"post",i).call(i,"/api/registerTemplate/checkSnList",e)},m.moveSnToCurrentTemp=function(e){return Object(s.a)((l=Object(r.a)(m),Object(d.a)(n.prototype)),"post",l).call(l,"/api/registerTemplate/dissociateSn",e)},m.deleteRegTemp=function(e){return Promise.all(e.map((function(e){return Object(s.a)((u=Object(r.a)(m),Object(d.a)(n.prototype)),"delete",u).call(u,"/api/registerTemplate/".concat(e))})))},m.updateRegTemp=function(e,t){return Object(s.a)((b=Object(r.a)(m),Object(d.a)(n.prototype)),"put",b).call(b,"/api/registerTemplate/".concat(e),t)},m.getTempDetail=function(e){return Object(s.a)((j=Object(r.a)(m),Object(d.a)(n.prototype)),"get",j).call(j,"/api/registerTemplate/"+e)},m}return Object(a.a)(n)}(u.a),j=new b;t.b=j},981:function(e,t,n){"use strict";n.r(t),n.d(t,"RegisterTempActions",(function(){return Q})),n.d(t,"regTempOperationMenus",(function(){return X}));var c=n(23),a=n(5),o=n(6),r=n(42),i=n(711),l=n(83),s=n(655),d=n(43),u=n(45),b=n(36),j=n(138),m=n(0),O=n(105),p=n(24),f=n(26),x=n(84),h=n(37),g=n(251),v=n(135),T=n(253),C=n(1),S=n(909);function w(e){var t,n,c=null===(t=e.content)||void 0===t?void 0:t.name;return Object(C.jsx)(v.b,{title:"regTemp.registDeviceByQrcode",hideFooter:!0,open:e.open,onClose:function(){e.onClose()},onOk:function(){},children:Object(C.jsxs)(r.a,{sx:{px:{lg:8,sm:3,xs:1},mt:-1},children:[Object(C.jsx)(r.a,{className:"flex",sx:{mb:1},children:Object(C.jsx)(l.a,{children:c})}),Object(C.jsx)(r.a,{sx:{mb:3,p:{lg:3,sm:1},border:1,borderColor:g.a,borderRadius:1},children:function(){try{var t;return Object(C.jsx)(S,{renderAs:"svg",style:{height:"100%",width:"100%"},value:JSON.stringify(null===(t=e.content)||void 0===t?void 0:t.qrCodeParams)})}catch(n){}}()}),Object(C.jsxs)(r.a,{sx:{mb:3},className:"flex-start flex-wrap",children:[Object(C.jsx)(l.a,{sx:{mr:1},fontSize:"14px",children:Object(h.b)("regTemp.tempCode")}),Object(C.jsx)(l.a,{sx:{mr:1.5},fontWeight:"bold",color:p.x,children:null===(n=e.content)||void 0===n?void 0:n.templateCode}),Object(C.jsx)(T.a,{fontSize:14,content:"regTemp.qrCodeTip"})]})]})})}var k=n(783),y=n(679),E=n(153);function D(e){var t=Object(m.useState)(e.name),n=Object(o.a)(t,2),c=n[0],i=n[1];Object(m.useEffect)((function(){i(e.name)}),[e.name,e.open]);return Object(C.jsx)(v.b,Object(a.a)(Object(a.a)({},e),{},{onOk:function(){if(c)return e.onOk(c);p.c.error("regTemp.nameRequired")},children:Object(C.jsxs)(r.a,{sx:{px:2},children:[Object(C.jsx)(E.a,{value:c,width:400,inputProps:{maxLength:24},label:"regTemp.tempName",name:"value",onChange:function(e){i(e.target.value)}}),Object(C.jsx)(r.a,{sx:{height:16}}),Object(C.jsx)(T.a,{content:"regTemp.max24Chars"})]})}))}var A=n(58),M=n(176),I=n(672),N=n(64),R=n(791),B=n(995),_=n(550),L=n(171),P=n(104),Y=n(179),z=n(684),U=A.a.getState().config.colors,W=[112,165,132];function q(e){var t=Object(L.a)().t,n=Object(P.b)(),c=e.selected?function(e){return Object(N.a)(e.palette.primary.main,.06)}:"#fff";return Object(C.jsxs)(R.a,{sx:{boxShadow:p.g,bgcolor:c},children:[Object(C.jsxs)(r.a,{className:"flex-start",sx:{px:3,pt:3,alignItems:"flex-start",flexWrap:"nowrap"},children:[e.showSelect&&Object(C.jsx)(Y.a,{sx:{mr:-1},value:e.selected,onChange:function(t){e.onSelectChange(t.target.checked)}}),Object(C.jsx)(i.a,{sx:{mr:2,height:48,width:48,bgcolor:g.c,borderRadius:2},children:e.detail.name[0]}),Object(C.jsxs)(r.a,{sx:{flex:1,maxWidth:"calc(100% - 118px)"},children:[Object(C.jsx)(l.a,{sx:{mb:.5},children:e.detail.name}),Object(C.jsx)(B.a,{title:e.detail.description,children:Object(C.jsx)(l.a,{className:"line-clamp",variant:"subtitle1",sx:{mb:1.5,whiteSpace:"pre"},children:e.detail.description||"-"})}),Object(C.jsx)(r.a,{className:"flex-start flex-nowrap",sx:{height:1,width:"calc(100% + 50px)",overflow:"hidden"},children:(Object(x.v)(e.detail)||[]).map((function(e,n){return Object(C.jsx)(y.a,{size:"small",sx:{mr:1,mb:.5},label:t(e),innerStyle:{maxWidth:W[n]},color:U[n]},n)}))})]}),!n&&Object(C.jsx)(O.a,{menus:X,onMenuClick:function(t){return e.onMenuClick(t,e.detail)}})]}),Object(C.jsx)(_.a,{sx:{mt:1.5}}),Object(C.jsx)(r.a,{className:"flex pointer",onClick:function(){return e.viewQrCode(e.detail)},sx:{py:1.5,"&:hover":{bgcolor:function(e){return Object(N.a)(e.palette.primary.main,.1)}}},children:Object(C.jsx)(z.a,{variant:"subtitle1",underline:"none",children:t("regTemp.viewQrCode")})})]})}var Q,V=n(139),F=n(671),G=n(174),H=A.a.getState().config.colors,J=[112,165,132];!function(e){e.EDIT="actions.edit",e.COPY="actions.copy",e.UPLOAD="actions.upload",e.DELETE="actions.delete"}(Q||(Q={}));var K,X=[new b.e(Q.EDIT,"common.edit","ic_edit"),new b.e(Q.COPY,"common.copy","ic_copy"),new b.e(Q.DELETE,"common.delete","ic_delete")];!function(e){e.BY_TITLE="name",e.BY_CREATED_TIME="createdTime"}(K||(K={}));var Z={xs:12,lg:6,xl:4},$=!1,ee=!0;t.default=function(){var e=Object(d.c)((function(e){return e.config})),t=Object(f.m)(),n=Object(m.useState)(!1),b=Object(o.a)(n,2),g=b[0],v=b[1],T=Object(m.useState)([]),S=Object(o.a)(T,2),E=S[0],A=S[1],N=Object(m.useState)(!1),R=Object(o.a)(N,2),B=R[0],_=R[1],L=Object(m.useState)(!1),Y=Object(o.a)(L,2),z=Y[0],U=Y[1],W=Object(m.useState)(null),te=Object(o.a)(W,2),ne=te[0],ce=te[1],ae=Object(m.useState)(new j.d(0,15,void 0,K.BY_CREATED_TIME,"desc")),oe=Object(o.a)(ae,2),re=oe[0],ie=oe[1],le=Object(m.useState)(!1),se=Object(o.a)(le,2),de=se[0],ue=se[1],be=Object(m.useState)(null),je=Object(o.a)(be,2),me=je[0],Oe=je[1],pe=Object(m.useState)([]),fe=Object(o.a)(pe,2),xe=fe[0],he=fe[1],ge=Object(m.useState)(I.a.CARD),ve=Object(o.a)(ge,2),Te=ve[0],Ce=ve[1],Se=Object(m.useState)({apkUrl:"https://mdm.bluesphere.cloud:9443/app/mdm/BS-MDM_release.apk",checkSum:"weY0DLiUTqyiMsVgyWqd-CUGScOunfw4m_TYrlsySfE"}),we=Object(o.a)(Se,2),ke=we[0],ye=we[1],Ee=Object(P.b)();Object(m.useEffect)((function(){k.b.getAgentDownloadUrl().then((function(e){ye(e)}))}),[]);var De=Object(m.useCallback)((function(){var e;ue(!0),$=!0,(e=re,k.b.getTemplates(e)).then((function(e){Te===I.a.LIST?(Oe(e),he(e.content),ue(!1)):(Oe(Object(a.a)(Object(a.a)({},e),{},{content:((null===me||void 0===me?void 0:me.content)||[]).concat(e.content)})),ue(!1),he(xe.concat(e.content))),ee=!(null!==e&&void 0!==e&&e.last),$=!1}))}),[re,Te]);Object(m.useEffect)((function(){De()}),[De]);var Ae=Object(m.useCallback)((function(e){var t=e.target,n=t.scrollTop;t.scrollHeight-n<=t.clientHeight&&!$&&ee&&($=!0,ie(Object(a.a)(Object(a.a)({},re),{},{page:re.page+1})))}),[re]);Object(m.useEffect)((function(){var e=document.getElementById("register-template-container");e&&(e.onscroll=Ae)}),[Te,Ae]);var Me=Object(m.useCallback)((function(){he([]),0!==re.page?ie(Object(a.a)(Object(a.a)({},re),{},{page:0})):(ie(Object(a.a)(Object(a.a)({},re),{},{page:0})),De())}),[De,re]),Ie=function(e){ce(e),_(!0)},Ne=e.height,Re=Object(m.useCallback)((function(e){var t=k.b.deleteRegTemp(e);return t.then((function(){A(E.filter((function(t){return!e.includes(t.id)}))),p.c.success("common.deleteSuccessed"),Me()})).catch((function(){p.c.error("common.deleteFailed")})),t}),[Me,E]),Be=Object(m.useCallback)((function(e){Object(p.a)({title:Object(h.b)("regTemp.deleteSingleTemplateTitle",{name:e.name}),content:Object(h.b)("common.deleteContent"),okBtnColor:"error",okText:"common.delete",onOk:function(){return Re([e.id])}})}),[Re]),_e=Object(m.useCallback)((function(e){ce(e),U(!0)}),[]),Le=Object(m.useCallback)((function(e){t("/reg-template/"+e.id)}),[t]),Pe=Object(m.useCallback)((function(e,t){switch(e){case Q.DELETE:Be(t);break;case Q.COPY:_e(t);break;case Q.EDIT:Le(t)}}),[Be,_e,Le]),Ye=function(e,t){E.find((function(e){return e.id===t.id}))?A(E.filter((function(e){return e.id!==t.id}))):A([].concat(Object(c.a)(E),[t]))},ze=Object(m.useCallback)((function(e){var t=k.b.updateRegTemp(e.id,e);return t.then((function(e){De()})),t}),[De]),Ue=Object(m.useMemo)((function(){var e=[new u.d("nameCircle","common.name","left",null,(function(e){var t;return Object(C.jsxs)(r.a,{sx:{px:2,flexWrap:"nowrap"},className:"flex-start",children:[Object(C.jsx)(i.a,{sx:{mt:"2px",mr:2,borderRadius:2,backgroundColor:function(e){return e.palette.primary.main}},children:null===(t=e.name)||void 0===t?void 0:t.substring(0,1)}),Object(C.jsx)(l.a,{children:e.name})]})}),!0),new u.c(ze,350),new u.d("configured","regTemp.configured",null,500,(function(e){var t=Object(x.v)(e);return Object(C.jsx)(r.a,{className:"flex-start",sx:{flexWrap:"nowrap",height:1,pl:2},children:(t||[]).map((function(e,t){return Object(C.jsx)(y.a,{size:"small",sx:{mr:2},label:Object(h.b)(e),innerStyle:{maxWidth:J[t]},color:H[t]},e)}))})})),new u.a("viewQrCode","regTemp.regist",200,(function(e){return Object(C.jsx)(r.a,{sx:{height:1,pl:0},className:"flex-start",children:Object(C.jsx)(M.a,{onClick:function(){return Ie(e)},children:Object(h.b)("regTemp.viewQrCode")})})}))];return Ee||e.push(new u.d("operation","device.operation","right",72,(function(e){return Object(C.jsx)(r.a,{children:Object(C.jsx)(O.a,{menus:X,onMenuClick:function(t){return Pe(t,e)}})})}),!0)),e}),[Pe,ze,Ee]),We=Object(C.jsx)(G.a,{type:"template",emptyTitle:"regTemp.emptyTitle"});return Object(C.jsxs)(r.a,{sx:{height:1},className:"content-container",children:[Object(C.jsx)(F.b,{sortProp:re.sortProperty,onSortChange:function(e){e!==re.sortProperty&&(he([]),ie(Object(a.a)(Object(a.a)({},re),{},{sortProperty:e,page:0})))},textSearch:re.textSearch,onSearchChange:function(e){he([]),ie(Object(a.a)(Object(a.a)({},re),{},{page:0,textSearch:e}))},deleteDisabled:(null===E||void 0===E?void 0:E.length)<=0,onAdd:function(){t("/reg-template/create")},onDelete:function(){Object(p.a)({title:Object(h.b)("regTemp.deleteMultiTemplateTitle",{count:null===E||void 0===E?void 0:E.length}),content:Object(h.b)("common.deleteContent"),okText:"common.delete",okBtnColor:"error",onOk:function(){return Re(E.map((function(e){return e.id})))}})},viewMode:Te,onViewModeChange:function(e){Ce(e),Oe(null),he([]),A([]),ie(Object(a.a)(Object(a.a)({},re),{},{page:0}))},selectAll:function(e){A(e?null===me||void 0===me?void 0:me.content:[])},deleteTitle:"regTemp.deletePolicy",addTitle:"regTemp.createTemp",showSelectBtn:!0,selectMode:g,setSelectMode:v,selectedCount:null===E||void 0===E?void 0:E.length,selectTitle:"regTemp.headerSelectTitle"}),Object(C.jsxs)(r.a,{sx:{height:"calc(100% - 56px)",bgcolor:"#fff",borderRadius:1},children:[Te===I.a.LIST&&Object(C.jsx)(u.g,{page:re.page,onCheckedChange:function(e,t){A(e?E.concat(t):E.filter((function(e){return e.id!==t.id})))},selected:E,onSelectChange:A,rows:null===me||void 0===me?void 0:me.content,totalPages:null===me||void 0===me?void 0:me.totalPages,pageSize:15,columns:Ue,showSelect:g,loading:de,pageChange:function(e){ie(Object(a.a)(Object(a.a)({},re),{},{page:e}))},height:Ne-245,children:We}),Te===I.a.CARD&&Object(C.jsx)(r.a,{id:"register-template-container",sx:{height:1,py:3,px:{sm:4.5,lg:7},overflow:"auto",boxSizing:"border-box"},children:Object(C.jsxs)(V.a,{size:"small",title:null,loading:de,sx:{},children:[(null===xe||void 0===xe?void 0:xe.length)>0&&Object(C.jsx)(s.a,{container:!0,spacing:3,children:null===xe||void 0===xe?void 0:xe.map((function(e){return Object(C.jsx)(s.a,Object(a.a)(Object(a.a)({},Z),{},{item:!0,children:Object(C.jsx)(q,{showSelect:g,selected:Boolean(E.find((function(t){return t.id===e.id}))),onSelectChange:function(t){return Ye(0,e)},detail:e,onMenuClick:Pe,viewQrCode:Ie})}),e.id)}))}),!de&&xe.length<=0&&We]})})]}),Object(C.jsx)(w,{agentInfo:ke,content:ne,open:B,onClose:function(){_(!1)}}),Object(C.jsx)(D,{title:"regTemp.copyTemplate",name:null===ne||void 0===ne?void 0:ne.name,open:z,onOk:function(e){var t=ne.description,n=ne.contentInfo,c=new x.q(e,t,Object(a.a)(Object(a.a)({},n),{},{deviceSnPool:{snList:[]}}));return new Promise((function(e,t){k.b.createTemp(c).then((function(n){if(n.success)Me(),e(),U(!1);else{var c=j.b.get(n.errorCode);p.c.error(c),t()}})).catch((function(){return t()}))}))},onClose:function(){U(!1)}})]})}}}]);