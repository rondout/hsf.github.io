(this["webpackJsonpui-ngx"]=this["webpackJsonpui-ngx"]||[]).push([[39],{684:function(e,t,n){"use strict";var c=n(7),a=n(740),i=Object(c.a)(a.a)((function(){return{cursor:"pointer"}}));t.a=i},960:function(e,t,n){"use strict";n.r(t);var c=n(42),a=n(0),i=n(43),r=n(26),s=n(20),o=n(47),l=n(139),j=n(6),u=n(83),b=n(995),d=n(134),h=n(171),O=n(110),x=n(79),m=n(24),p=n(51),f=n(135),g=n(261),v=n(1);function _(){var e,t=Object(h.a)().t,n=Object(a.useState)(!1),s=Object(j.a)(n,2),l=s[0],_=s[1],w=Object(r.m)(),N=Object(i.b)(),E=null===(e=Object(i.c)(o.k).license)||void 0===e?void 0:e.tenantIdentifier;return Object(v.jsx)(c.a,{children:Object(v.jsx)(f.b,{open:!0,hideFooter:!0,onClose:null,size:"md",title:"user.licenseExpireTitle",children:Object(v.jsxs)(c.a,{className:"flex flex-column",children:[Object(v.jsx)(p.a,{icon:"ic_alert",fontSize:64,color:"red"}),Object(v.jsx)(u.a,{sx:{my:3},variant:"h3",children:t("user.licenseExpireTip")}),Object(v.jsx)(u.a,{children:t("user.licenseExpireDesc")}),E&&Object(v.jsxs)(c.a,{sx:{my:3},className:"flex",children:[Object(v.jsx)(u.a,{children:t("license.tenantIdentifier")}),Object(v.jsx)(b.a,{placement:"top",title:t("user.clickToCopy"),children:Object(v.jsx)(u.a,{onClick:function(e){Object(m.h)(E,e)},className:"pointer",sx:{ml:2,"&:hover":{color:function(e){return e.palette.primary.main}}},children:E})})]}),Object(v.jsx)(g.a,{accept:".lic",loading:l,onFileChange:function(e){_(!0);var t=new FormData;t.append("file",e[0]),O.a.uploadLicense(t).then((function(){m.c.success("user.licenseUpdated"),_(!1)})).catch((function(e){var t;(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)&&m.c.error(e.data.message),_(!1)}))},variant:"contained",children:t("user.uploadLicense")}),Object(v.jsx)(c.a,{className:"flex-end",sx:{mt:1,width:1},children:Object(v.jsx)(d.a,{onClick:function(){window.localStorage.removeItem("jwt_token"),window.localStorage.removeItem("refresh_jwt_token"),w("/login",{replace:!0}),N(Object(x.c)({userInfo:{},tenantInfo:{}}))},children:t("user.userMenus.LOG_OUT")})})]})})})}var w=n(217),N=Object(w.a)((function(e){var t;return{box:{background:null===(t=e.custom)||void 0===t?void 0:t.background}}}));function E(e){var t=N();return Object(v.jsx)(c.a,{sx:{flex:1,py:1.5,px:1.5,overflowY:"auto",height:"calc(100% - 94px)"},className:"main-container "+t.box,children:e.children})}var I=n(998),M=n(999),S=n(354),k=n(248),T=n(904),y=n.n(T),C=n(294),G=n.n(C),L=n(36),A=n(293),z=n(711),R=n(251),D=n(979),F=n(141),P=n(33),U=n(684);function Y(){var e,t=Object(i.c)(o.d),n=Object(h.a)().t,l=Object(r.j)().pathname,j=Object(r.m)(),b=Object(i.c)(o.b),d=Object(a.useMemo)((function(){return Object(F.c)(t)}),[t]),O=Object(s.l)(d,l),x=[];if(null!==O&&void 0!==O&&O.length){var m=O[O.length-1].route.path;x=P.b.get(m)||[]}var f=null===(e=x[0])||void 0===e?void 0:e.title;return Object(v.jsxs)(c.a,{children:[Object(v.jsx)(u.a,{variant:"h6",children:n("user.navTitles."+f)}),x.length>1&&!b&&Object(v.jsx)(D.a,{separator:Object(v.jsx)(p.a,{mr:0,fontSize:16,icon:"ic_arrow_right"}),"aria-label":"breadcrumb",children:x.map((function(e,t){return t===x.length-1?Object(v.jsx)(u.a,{color:"textPrimary",children:n("user.navTitles."+e.title)},e.path):Object(v.jsx)(U.a,{underline:"none",color:"inherit",onClick:function(){return t=e.path,void j(t);var t},children:n("user.navTitles."+e.title)},e.path)}))})]})}var B,J=n(104);!function(e){e[e.PROFILE=0]="PROFILE",e[e.ADMIN_MANAGEMENT=1]="ADMIN_MANAGEMENT",e[e.ORG_SETTINGS=2]="ORG_SETTINGS",e[e.LICENSE=3]="LICENSE",e[e.LOG_OUT=4]="LOG_OUT"}(B||(B={}));var W=[new L.e(B.PROFILE,"user.userMenus.PROFILE","ic_personal"),new L.e(B.ADMIN_MANAGEMENT,"user.userMenus.ADMIN_MANAGEMENT","ic_admin"),new L.e(B.ORG_SETTINGS,"user.userMenus.ORG_SETTINGS","ic_team"),new L.e(B.LICENSE,"user.userMenus.LICENSE","ic_license_outlined"),new L.e(B.LOG_OUT,"user.userMenus.LOG_OUT","ic_logout")],H=[W[0],W[4]];function V(){var e=Object(h.a)().t,t=Object(r.m)(),n=Object(i.c)(o.e),s=a.useState(null),l=Object(j.a)(s,2),b=l[0],d=l[1],O=a.useState(null),m=Object(j.a)(O,2),f=m[0],g=m[1],_=Boolean(b),w=Boolean(f),N=Object(i.b)(),E=Object(J.c)(),T=Object(i.c)(o.m),C=T.name,L=T.avatar,D=T.email,F=a.useMemo((function(){return E?W:H}),[E]),P=function(e){d(e.currentTarget)},U=function(){g(null)},V=function(){d(null),U()},q=function(){window.localStorage.removeItem("jwt_token"),window.localStorage.removeItem("refresh_jwt_token"),t("/login",{replace:!0}),N(Object(x.c)({userInfo:{},tenantInfo:{}}))},K=Object(v.jsxs)(A.a,{anchorEl:b,anchorOrigin:{vertical:"top",horizontal:"right"},id:"primary-search-account-menu",keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:_,onClose:V,children:[Object(v.jsxs)(c.a,{sx:{px:2,py:1},className:"flex-start",children:[Object(v.jsx)(z.a,{src:L,sx:{color:"#fff",bgcolor:function(e){return e.palette.primary.main},mr:2},children:null===C||void 0===C?void 0:C.substring(0,1)}),Object(v.jsxs)(c.a,{children:[Object(v.jsx)(u.a,{children:C}),Object(v.jsx)(u.a,{color:R.b,children:D})]})]}),F.map((function(n){return Object(v.jsxs)(k.a,{onClick:function(){!function(e){switch(V(),e){case B.PROFILE:t("/user/profile");break;case B.ADMIN_MANAGEMENT:t("/user/admin-management");break;case B.ORG_SETTINGS:t("/user/orgnization");break;case B.LICENSE:t("/user/subscription");break;case B.LOG_OUT:q()}}(n.action)},children:[Object(v.jsx)(p.a,{fontSize:24,icon:n.icon,mr:2}),Object(v.jsx)(u.a,{children:e(n.title)})]},n.action)}))]}),Q="primary-search-account-menu-mobile",X=Object(v.jsx)(A.a,{anchorEl:f,anchorOrigin:{vertical:"top",horizontal:"right"},id:Q,keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:w,onClose:U,children:Object(v.jsxs)(k.a,{onClick:P,children:[Object(v.jsx)(S.a,{size:"large","aria-label":"account of current user","aria-controls":"primary-search-account-menu","aria-haspopup":"true",color:"inherit",children:Object(v.jsx)(y.a,{})}),Object(v.jsx)("p",{children:"Profile"})]})});return Object(v.jsxs)(c.a,{sx:{zIndex:1},children:[Object(v.jsx)(I.a,{color:"transparent",position:"static",sx:{boxShadow:2,height:72},children:Object(v.jsxs)(M.a,{sx:{height:1,zIndex:1,boxShadow:"0px 1px 4px 2px rgba(44, 57, 127, 0.08)"},children:[Object(v.jsx)(S.a,{sx:{mr:2},size:"medium",edge:"start",color:"inherit","aria-label":"open drawer",onClick:function(){N(Object(x.a)())},children:Object(v.jsx)(p.a,{icon:n?"ic_menu_fold":"ic_menu_unfold",mr:0})}),Object(v.jsx)(Y,{}),Object(v.jsx)(c.a,{sx:{flexGrow:1}}),Object(v.jsx)(c.a,{sx:{display:{xs:"none",md:"flex"}},children:Object(v.jsx)(c.a,{className:"flex",children:Object(v.jsx)(z.a,{src:L,className:"pointer",onClick:P,sx:{color:"#fff",bgcolor:function(e){return e.palette.primary.main},mr:2},children:null===C||void 0===C?void 0:C.substring(0,1)})})}),Object(v.jsx)(c.a,{sx:{display:{xs:"flex",md:"none"}},children:Object(v.jsx)(S.a,{size:"large","aria-label":"show more","aria-controls":Q,"aria-haspopup":"true",onClick:function(e){g(e.currentTarget)},color:"inherit",children:Object(v.jsx)(G.a,{})})})]})}),X,K]})}var q=n(550),K=n(5),Q=n(562),X=n(951),Z=n(664),$=Object(a.memo)((function(e){var t=e.data,n=Object(h.a)().t,c=Object(r.m)(),a=Object(r.j)(),l=Object(i.c)(o.e),j=t.pathMatch.some((function(e){return t=e,Object(s.k)(t,a.pathname);var t}));return Object(v.jsx)(Q.a,{sx:{width:"100%",maxWidth:360,bgcolor:"transparent",color:"background.default",py:0,px:1,boxSizing:"border-box"},component:"nav","aria-labelledby":"nested-list-subheader",children:Object(v.jsxs)(Z.a,{onClick:function(){return c(t.path)},sx:[Object(K.a)({pl:2.25,borderRadius:2},Ie),j?{"&:hover":{bgcolor:"primary.main",opacity:1},bgcolor:"primary.main",opacity:1}:{}],children:[Object(v.jsx)(p.a,{my:.5,mr:2,color:"#fff",icon:t.icon}),l&&Object(v.jsx)(X.a,{sx:{whiteSpace:"nowrap"},primary:n("nav."+t.title)})]})})})),ee=n(836),te=n(905),ne=n.n(te),ce=n(764),ae=n.n(ce),ie=n(566),re=Object(a.memo)((function(e){var t,n=e.data,i=Object(a.useState)(!1),s=Object(j.a)(i,2),o=s[0],l=s[1],u=Object(h.a)().t,b=Object(r.j)(),d=Object(a.useCallback)((function(){var e,t=null===(e=b.pathname)||void 0===e?void 0:e.includes(n.path);l(t)}),[]);Object(a.useEffect)((function(){return d(),function(){console.log("willUnMount")}}),[d]);return Object(v.jsxs)(Q.a,{sx:{width:"100%",maxWidth:360,bgcolor:"transparent",color:"background.default",mb:0,pt:0,pb:0},component:"nav","aria-labelledby":"nested-list-subheader",children:[Object(v.jsxs)(Z.a,{onClick:function(){l(!o)},sx:Object(K.a)(Object(K.a)({},Ie),{},{mt:0,pl:3}),children:[Object(v.jsx)(ie.a,{sx:{mr:2},children:n.icon}),Object(v.jsx)(X.a,{primary:u("nav."+n.title)}),o?Object(v.jsx)(ne.a,{}):Object(v.jsx)(ae.a,{})]}),Object(v.jsx)(ee.a,{in:o,timeout:"auto",unmountOnExit:!0,children:Object(v.jsx)(Q.a,{component:"div",disablePadding:!0,children:null===(t=n.children)||void 0===t?void 0:t.map((function(e,t){return Object(v.jsx)(c.a,{sx:{borderRadius:2,ml:0},children:Object(v.jsx)($,{sx:{},data:e})},t)}))})})]})})),se=n(23),oe=n(13),le=n(14),je=n(34),ue=Object(oe.a)((function e(t,n,c,a,i){var r=arguments.length>5&&void 0!==arguments[5]&&arguments[5];Object(le.a)(this,e),this.title=t,this.path=n,this.pathMatch=c,this.icon=a,this.children=i,this.isDivider=r})),be={auth:Object(se.a)(je.c),data:new ue("dashboard","/",["/"],"ic_menu_dashboard_selected")},de={auth:[je.b.SYS_ADMIN],data:new ue("tenantManagement","/tenants",["/tenants"],"ic_menu_dashboard_selected")},he={auth:[je.b.SYS_ADMIN],data:new ue("licenseManagement","/licenses",["/licenses"],"ic_license")},Oe={auth:je.c,data:new ue("registTemplate","/reg-template",["/reg-template","/reg-template/*"],"ic_menu_register_selected")},xe={auth:je.c,data:new ue("deviceManagement","/device-management",["/device-management","/groups/*","/devices/*"],"ic_menu_device__selected")},me={auth:je.c,data:new ue("settingsTemplate","/settings-template",["/settings-template","/settings-template/*"],"ic_menu_configure")},pe={auth:je.g,data:new ue("geofence","/geofence",["/geofence","/geofence/*"],"geofence")},fe={auth:je.c,data:new ue("pipeline","/pipelines",["/pipelines","/pipelines/*"],"pipeline")},ge={auth:je.c,data:new ue("application","/application",["/application"],"ic_menu_application_selected")},ve=[be,de,he,Oe,xe,me,pe,fe,{auth:je.a,data:new ue(null,null,null,null,null,!0)},ge,{auth:je.c,data:new ue("file","/file",["/file"],"ic_menu_document")}];var _e=n.p+"static/media/logo.2e6885c8.svg",we=n.p+"static/media/text.0c1cd71e.svg",Ne=Object(w.a)((function(){return{headerContainer:{background:"#00000099"},headerContent:{display:"flex",alignItems:"center",justifyContent:"center"},title:{marginTop:12,marginLeft:0}}}));function Ee(){var e=Ne(),t=Object(i.c)(o.e);return Object(v.jsx)(c.a,{className:e.headerContainer,sx:{height:116,p:2,boxSizing:"border-box"},children:Object(v.jsxs)(c.a,{className:e.headerContent,sx:{height:1,textAlign:"center"},children:[Object(v.jsx)("img",{src:_e,alt:"",width:48,height:48}),Object(v.jsx)("img",{style:{display:t?"unset":"none"},src:we,alt:"",width:140,className:e.title})]})})}var Ie={opacity:.7};function Me(){var e=Object(i.c)(o.d),t=Object(a.useMemo)((function(){return t=e,ve.filter((function(e){return e.auth.includes(t)})).map((function(e){return e.data}));var t}),[e]),n=Object(i.c)(o.i);return Object(v.jsxs)(c.a,{sx:{width:n,height:"100%",transition:"width 0.3s",bgcolor:m.x},children:[Object(v.jsx)(Ee,{}),Object(v.jsx)(c.a,{sx:{height:"calc(100% - 130px)",overflowY:"auto",pb:0,pt:1.5,bgcolor:"#00000080"},children:t.map((function(e,t){return e.isDivider?Object(v.jsx)(q.a,{sx:{my:2,borderColor:"#ffffff33"}},t):e.children?Object(v.jsx)(re,{data:e},t):Object(v.jsx)($,{data:e},t)}))})]})}var Se=function(){return Object(v.jsx)(c.a,{className:"left-nav-container",children:Object(v.jsx)(Me,{})})},ke=n(986),Te=function(e){var t=Object(i.b)();return Object(v.jsx)(ke.a,{onClose:function(){return t(Object(x.a)())},open:e.collapsed,children:Object(v.jsx)(Me,{})})};n(906),n(907),n(908);function ye(){var e=Object(r.m)(),t=Object(h.a)().t;return Object(v.jsx)(c.a,{children:Object(v.jsx)(f.b,{open:!0,hideFooter:!0,onClose:null,size:"sm",title:null,children:Object(v.jsxs)(c.a,{className:"flex flex-column",children:[Object(v.jsx)(u.a,{variant:"h3",children:t("user.noPermissionForThisPage")}),Object(v.jsx)(d.a,{sx:{mt:4,mb:2},variant:"contained",onClick:function(){return e("/")},children:t("common.backHome")})]})})})}var Ce=Object(a.memo)((function(){var e=Object(i.c)((function(e){return e.config})),t=Object(i.c)(o.a),n=Object(i.c)(o.o),j=n.isLogin,u=n.licenseValid,b=Object(i.c)(o.d),d=e.getUserInfoFinish,h=e.collapsed,O=Object(r.j)().pathname,x=Object(a.useMemo)((function(){var e=Object(s.l)(F.b,O);if(null!==e&&void 0!==e&&e.length){var t=e[e.length-1],n=null===t||void 0===t?void 0:t.route,c=null===n||void 0===n?void 0:n.auth;return!c||c.includes(b)}}),[O,b]),m=Object(a.useMemo)((function(){return t?"100%":h&&!t?"calc(100% - 240px)":"calc(100% - 80px)"}),[h,t]);return d?j&&u?Object(v.jsxs)(c.a,{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"space-between"},children:[t?Object(v.jsx)(Te,{collapsed:h}):Object(v.jsx)(Se,{}),Object(v.jsxs)(c.a,{sx:{height:1,width:m,transition:"width .3s"},children:[Object(v.jsx)(V,{}),Object(v.jsx)(E,{children:x?Object(v.jsx)(r.b,{}):Object(v.jsx)(ye,{})})]})]}):u?Object(v.jsx)(r.a,{to:"/login"}):Object(v.jsx)(_,{}):Object(v.jsx)(l.a,{})}));t.default=Ce}}]);