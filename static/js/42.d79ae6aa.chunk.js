(this["webpackJsonpui-ngx"]=this["webpackJsonpui-ngx"]||[]).push([[42],{710:function(e,t,c){"use strict";var n=c(13),a=c(14),i=c(18),s=c(30),r=c(31),o=c(17),l=c(12),b=function(e){Object(s.a)(c,e);var t=Object(r.a)(c);function c(){var e,n,s,r,b,j;Object(a.a)(this,c);for(var p=arguments.length,m=new Array(p),d=0;d<p;d++)m[d]=arguments[d];return(j=t.call.apply(t,[this].concat(m))).createTemplate=function(t){return Object(o.a)((e=Object(i.a)(j),Object(l.a)(c.prototype)),"post",e).call(e,"/api/deviceSettingTemplate/create",t)},j.updateTemplate=function(e,t){return Object(o.a)((n=Object(i.a)(j),Object(l.a)(c.prototype)),"put",n).call(n,"/api/deviceSettingTemplate/".concat(e),t)},j.getTemplates=function(e){return Object(o.a)((s=Object(i.a)(j),Object(l.a)(c.prototype)),"get",s).call(s,"/api/deviceSettingTemplates",{params:e})},j.deleteTemplate=function(e){return Object(o.a)((r=Object(i.a)(j),Object(l.a)(c.prototype)),"delete",r).call(r,"/api/deviceSettingTemplate/".concat(e))},j.deleteTemplates=function(e){return Promise.all(e.map((function(e){return j.deleteTemplate(e)})))},j.getTemplateById=function(e){return Object(o.a)((b=Object(i.a)(j),Object(l.a)(c.prototype)),"get",b).call(b,"/api/deviceSettingTemplate/".concat(e))},j}return Object(n.a)(c)}(c(107).a),j=new b;t.a=j},988:function(e,t,c){"use strict";c.r(t),c.d(t,"default",(function(){return D}));var n,a=c(5),i=c(6),s=c(249),r=c(64),o=c(42),l=c(134),b=c(550),j=c(217),p=c(154),m=c(37),d=c(43),u=function(e){return e.settingsTemp.settingsTempDetail.contentInfo},O=function(e){var t=e.settingsTemp.settingsTempDetail;return{name:t.name,description:t.description,deviceCount:t.deviceCount}},x=c(153),f=c(93),g=c(253),h=c(722),T=c(0),v=c(24),C=c(26),S=c(241),w=c(139),E=c(710),N=c(29),I=c(678),y=c(138),k=c(135),R=c(83),A=c(33),z=c(1),F=Object(j.a)((function(e){return{contentContainer:{height:"100%",boxSizing:"border-box",overflow:"hidden"},container:{boxShadow:"0px 1px 4px 2px rgb(44 57 127 / 12%)",borderRadius:8},header:{padding:e.custom.templateConfigCardPadding,boxSizing:"border-box",boxShadow:"0px 2px 2px 0 "+Object(r.a)(Object(r.b)(e.palette.primary.main,.3),.08)},dot:{height:18,width:4,background:e.palette.primary.main,marginRight:8},title:{fontSize:20},content:{padding:24,maxHeight:"calc(100% - 80px)",paddingTop:32,overflowY:"auto",boxSizing:"border-box"}}}));function D(){var e=F(),t=Object(d.b)(),c=Object(T.useState)(n.CREATE),r=Object(i.a)(c,2),j=r[0],D=r[1],P=Object(T.useRef)(),V=Object(C.m)(),_=Object(T.useState)(!0),q=Object(i.a)(_,2),B=q[0],G=q[1],H=Object(d.c)(O),J=Object(d.c)(u),L=Object(T.useState)(""),M=Object(i.a)(L,2),W=M[0],X=M[1],Y=Object(T.useState)(!1),K=Object(i.a)(Y,2),Q=K[0],U=K[1],Z=Object(C.o)();Object(T.useEffect)((function(){var e=Z.id;X(e),e?(D(n.EDIT),E.a.getTemplateById(e).then((function(e){X(e.id);var c,n=e.contentInfo,a=e.name,i=e.description,s=void 0===i?"":i,r=e.deviceCount;t((c={name:a,description:s,contentInfo:n,deviceCount:r},{type:N.e.INIT_WITH_ARGS,data:c})),G(!1)})).catch((function(e){Object(v.p)(e),G(!1)}))):(t({type:N.e.INIT_CONFIG_DETAIL}),D(n.CREATE),G(!1)),console.log(Z)}),[Z,t]);var $=Object(T.useCallback)((function(){t(Object(I.b)())}),[t]);Object(T.useEffect)((function(){return $}),[$]);var ee=Object(p.a)({initialValues:H,validationSchema:f.b({name:f.c().required(Object(m.b)("regTemp.nameRequired")).max(24,Object(m.b)("regTemp.tempNameMax24"))}),validateOnMount:!0,onSubmit:function(e){}});Object(T.useEffect)((function(){ee.setValues(H)}),[H]);return B?Object(z.jsx)(o.a,{sx:{height:1},children:Object(z.jsx)(w.a,{})}):H.deviceCount>0?Object(z.jsx)(o.a,{children:Object(z.jsx)(k.b,{open:!0,hideFooter:!0,onClose:null,size:"sm",title:null,children:Object(z.jsxs)(o.a,{className:"flex flex-column",children:[Object(z.jsx)(R.a,{variant:"h3",children:Object(m.b)("settingsTemp.cantEditTemplate")}),Object(z.jsx)(l.a,{sx:{mt:4,mb:2},variant:"contained",onClick:function(){return V(A.a.SettingsTemplate)},children:Object(m.b)("common.back")})]})})}):Object(z.jsx)(o.a,{sx:{p:2,pb:1},className:"config-temp-container "+e.contentContainer,children:Object(z.jsxs)(o.a,{sx:{bgcolor:"#fff",height:1},className:e.container,children:[Object(z.jsxs)(o.a,{className:e.header+" flex-between",sx:{height:80,boxSizing:"border-box"},children:[Object(z.jsxs)(o.a,{className:"flex",children:[Object(z.jsx)("div",{className:e.dot}),Object(z.jsx)("span",{className:e.title,children:Object(m.b)("settingsTemp."+j)})]}),Object(z.jsxs)(o.a,{children:[Object(z.jsx)(l.a,{onClick:function(){Object(v.a)({title:"settingsTemp.backTitle",content:"settingsTemp.backContent",onOk:function(){V("/settings-template")}})},sx:{ml:2},children:Object(m.b)("common.cancel")}),Object(z.jsx)(s.a,{loading:Q,onClick:function(){ee.validateForm().then((function(e){console.log(e),null!==e&&void 0!==e&&e.name?v.c.error(e.name):P.current.validateForm(!0).then((function(e){if(P.current.isValid){var t=ee.values,c=t.name,a=t.description;i=new S.a(c,a,P.current.values),U(!0),j===n.CREATE?E.a.createTemplate(i).then((function(e){if(U(!1),e.success)v.c.success("settingsTemp.createTempSuccessed"),V("/settings-template");else{var t=y.b.get(e.errorCode);v.c.error(t)}})):E.a.updateTemplate(W,i).then((function(e){if(U(!1),e.success)v.c.success("settingsTemp.editTempSuccessed"),V("/settings-template");else{var t=y.b.get(e.errorCode);v.c.error(t)}})).catch(v.p)}else Object.values(e)[0]&&v.c.error(Object.values(e)[0]);var i}))}))},variant:"contained",sx:{ml:2},children:Object(z.jsx)("span",{children:Object(m.b)("common.save")})})]})]}),Object(z.jsxs)(o.a,{className:e.content,children:[Object(z.jsxs)("form",{action:"",children:[Object(z.jsxs)(o.a,{className:"flex-start",sx:{mt:2,pt:0,pb:2},children:[Object(z.jsx)(x.a,Object(a.a)(Object(a.a)({width:300,label:"common.name",inputProps:{maxLength:24}},ee.getFieldProps("name")),{},{error:Boolean(ee.touched.name&&ee.errors.name)})),Object(z.jsx)(o.a,{sx:{width:12}}),Object(z.jsx)(g.a,{content:"regTemp.tempNameRequired"})]}),Object(z.jsx)(o.a,{className:"flex-start",sx:{mt:3},children:Object(z.jsx)(x.a,Object(a.a)({rows:2,multiline:!0,width:450,maxRows:5,placeholder:Object(m.b)("settingsTemp.holders.description"),label:Object(m.b)("common.description")},ee.getFieldProps("description")))})]}),Object(z.jsx)(b.a,{sx:{m:4,marginX:0}}),Object(z.jsx)(h.a,{ref:P,initialValues:J})]})]})})}!function(e){e.EDIT="editTemplate",e.CREATE="createTemplate"}(n||(n={}))}}]);