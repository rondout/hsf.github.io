(this["webpackJsonpui-ngx"]=this["webpackJsonpui-ngx"]||[]).push([[25],{678:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"i",(function(){return r})),n.d(t,"g",(function(){return l})),n.d(t,"d",(function(){return s})),n.d(t,"h",(function(){return u})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return j}));var c=n(29),a=function(e){return{type:c.d.INIT_CONFIG_DETAIL,data:e}},i=function(){return{type:c.d.RESET_CONFIG}},o=function(e){return{type:c.d.SET_BASIC_CONFIG,data:e}},r=function(e){return{type:c.d.SET_SETTINGS_CONFIG,data:e}},l=function(e){return{type:c.d.SET_KIOSK_INFO,data:e}},s=function(e){return{type:c.d.SET_DEVICE_CONFIG,data:e}},u=function(e){return{type:c.d.SET_PART_DEVICE_CONFIG,data:e}},d=function(e){return{type:c.d.SET_DEVICE_GROUP,data:e}},j=function(e){return{type:c.d.SET_DEVICE_POOL,data:e}}},679:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var c=n(5),a=n(42),i=n(64),o=n(83),r=n(1);function l(e){var t=e.size,n=void 0===t?"medium":t;return Object(r.jsx)(a.a,{sx:Object(c.a)({userSelect:"none",borderRadius:1.5,height:"small"===n?24:32,fontSize:14,display:"inline-flex",alignItems:"center",lineHeight:"small"===n?"24px":"32px",whiteSpace:"nowrap",px:"small"===n?1:1.5,bgcolor:Object(i.a)(e.color,.1)},e.sx),children:Object(r.jsx)("span",{className:"custom-chip-inner",style:{whiteSpace:"nowrap",color:e.color},children:Object(r.jsx)(o.a,{className:"line-clamp",style:e.innerStyle,children:e.label})})})}},680:function(e,t,n){"use strict";n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return u})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return j}));var c=n(84),a=function(e){return e.regTemp.regTempDetail},i=function(e){var t=e.regTemp.regTempDetail;return{name:t.name,description:t.description}},o=function(e){var t;return null===(t=e.regTemp.regTempDetail)||void 0===t?void 0:t.contentInfo.setting},r=function(e){var t;return null===(t=e.regTemp.regTempDetail)||void 0===t?void 0:t.contentInfo.kiosk},l=function(e){var t,n=null===(t=e.regTemp.regTempDetail)||void 0===t?void 0:t.contentInfo.config;return n.wifiForProvision||(n.wifiForProvision=c.w),n},s=function(e){var t;return null===(t=e.regTemp.regTempDetail)||void 0===t?void 0:t.contentInfo.deviceGroup},u=function(e){var t;return null===(t=e.regTemp.regTempDetail)||void 0===t?void 0:t.contentInfo.deviceSnPool},d=function(e){var t;return null===(t=e.regTemp.regTempDetail)||void 0===t?void 0:t.contentInfo.setting.adb},j=function(e){var t;return null===(t=e.regTemp.regTempDetail)||void 0===t?void 0:t.contentInfo.setting.bluetooth}},692:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var c=n(6),a=n(42),i=n(37),o=n(0),r=n(250),l=n(24),s=n(153),u=n(135),d=n(253),j=n(1);function b(e){var t=e.parentId,n=Object(o.useState)(""),b=Object(c.a)(n,2),f=b[0],O=b[1],p=function(){O(""),e.onClose()};return Object(j.jsx)(u.b,{transparentTitleBg:!0,title:"regTemp.addDeviceGroup",open:e.open,onClose:p,onOk:function(){if(f){var n=r.f.createGroup({parentId:t,deviceGroupName:f});return n.then((function(t){e.onOk(),p()})),n}l.c.error("device.errors.needGroupName")},children:Object(j.jsxs)(a.a,{sx:{pl:2},className:"flex-start flex-wrap",children:[Object(j.jsx)(a.a,{sx:{width:300,mr:2},children:Object(j.jsx)(s.a,{name:"groupName",onChange:function(e){O(e.target.value)},label:"common.name",value:f,placeholder:Object(i.b)("regTemp.holders.groupName"),inputProps:{maxLength:12}})}),Object(j.jsx)(d.a,{content:"regTemp.max12Chars"})]})})}},693:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var c=n(5),a=n(3),i=n(0),o=n(915),r=n(993),l=n(8),s=n(83),u=n(64),d=n(42),j=n(995),b=n(354),f=n(555),O=n(51),p=n(37),x=n(43),m=n(47),v=n(1);function h(e){var t=i.forwardRef((function(t,n){var c,i,r=Object(x.c)(m.l),h=e.sx,g=void 0===h?{}:h,C=t.classes,w=t.className,I=t.label,E=t.nodeId,S=t.icon,k=t.expansionIcon,N=t.displayIcon,T=Object(o.a)(E),y=T.disabled,G=T.expanded,D=T.selected,_=T.focused,P=T.handleExpansion,A=T.handleSelection,F=T.preventSelection,V=S||k||N,M=function(e,t){e.stopPropagation(),t instanceof Function&&t()},R=Object(u.e)(r,.3);return Object(v.jsxs)(d.a,{className:Object(l.a)(w,C.root,(c={},Object(a.a)(c,C.expanded,G),Object(a.a)(c,C.selected,D),Object(a.a)(c,C.focused,_),Object(a.a)(c,C.disabled,y),c)),onMouseDown:function(e){F(e)},ref:n,sx:g,children:[Object(v.jsx)(d.a,{onClick:function(e){P(e)},className:C.iconContainer,children:V}),Object(v.jsxs)(d.a,{className:"flex",style:{flex:1,height:"100%",marginLeft:4,overflow:"hidden"},onClick:function(){e.ContentProps.onSelected&&e.ContentProps.onSelected({name:t.label,id:t.nodeId})},children:[Object(v.jsx)(O.a,{fontSize:32,icon:"ic_menu_device1",color:R}),Object(v.jsx)(s.a,{onClick:function(e){A(e)},component:"div",sx:{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"},className:C.label,children:I}),!1!==e.ContentProps.showAddButton&&Object(v.jsx)(j.a,{title:Object(p.b)("device.addGroup"),children:Object(v.jsx)(b.a,{onClick:function(t){return M(t,e.ContentProps.onAddClick)},className:"tree-item-operation flex",size:"small",children:Object(v.jsx)(O.a,{mr:0,icon:"ic_add1"})})}),e.ContentProps.onDetailClick&&Object(v.jsx)(b.a,{sx:{ml:0},onClick:function(t){return M(t,e.ContentProps.onDetailClick)},className:"tree-item-operation flex",size:"small",children:Object(v.jsx)(O.a,{mr:0,icon:"ic_look"})}),null===(i=e.ContentProps.operationComponents)||void 0===i?void 0:i.map((function(e){return e})),e.ContentProps.showRadio&&Object(v.jsx)(f.a,{onChange:function(t){return e.ContentProps.onChange(t)},checked:e.checked})]})]})}));return Object(v.jsx)(r.a,Object(c.a)({ContentComponent:t},e))}},705:function(e,t,n){"use strict";n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return N}));var c=n(6),a=n(5),i=n(1004),o=n(7),r=n(64),l=n(42),s=n(83),u=n(550),d=n(555),j=n(37),b=n(0),f=n(43),O=n(250),p=n(678),x=n(47),m=n(680),v=n(173),h=n(174),g=n(51),C=n(692),w=n(693),I=n(253),E=n(1),S={padding:"0 16px",boxShadow:"0px 1px 4px 2px rgb(44 57 127 / 12%)",marginBottom:12,borderRadius:4,height:56,width:360},k=Object(o.a)(i.a)((function(e){var t=e.theme;return{padding:"16px 32px","& .Mui-focused":{backgroundColor:"transparent !important"},"& .Mui-selected":{backgroundColor:Object(r.a)(t.palette.primary.main,.1)+" !important","& .tree-item-operation":{display:"block"}}}})),N=Object(o.a)(w.a)((function(e){e.theme;return{".MuiTreeItem-content":Object(a.a)(Object(a.a)({},S),{},{"& .tree-item-operation":{display:"none"},"&:hover .tree-item-operation":{display:"block !important"}}),"&:hover .MuiTreeItem-content":{}}})),T=Object(b.forwardRef)((function(e,t){var n=Object(b.useState)(""),i=Object(c.a)(n,2),o=i[0],r=i[1],w=Object(f.c)(x.c),T=Object(b.useState)([]),y=Object(c.a)(T,2),G=y[0],D=y[1],_=Object(b.useState)(""),P=Object(c.a)(_,2),A=P[0],F=P[1],V=Object(f.b)(),M=Object(f.c)(m.b),R=Object(b.useMemo)((function(){return[null===M||void 0===M?void 0:M.id]}),[]),z=Object(b.useState)((null===M||void 0===M?void 0:M.id)||null),L=Object(c.a)(z,2),B=L[0],W=L[1],H=Object(b.useState)(M),q=Object(c.a)(H,2),U=q[0],Y=q[1],J=Object(b.useState)(!1),K=Object(c.a)(J,2),Q=K[0],X=K[1],Z=Object(b.useCallback)((function(){V(Object(p.e)(U))}),[U,V]);Object(b.useEffect)((function(){return Z}),[Z]);var $=Object(b.useCallback)((function(){O.f.getAllGroupTree().then((function(e){e.success&&D(e.nodeList)}))}),[]);Object(b.useImperativeHandle)(t,(function(){return{validateForm:function(){return new Promise((function(e,t){Boolean(U)?e({}):e({message:"regTemp.groupRequired"})}))},isValid:Boolean(U),values:U}})),Object(b.useEffect)((function(){A?O.f.searchGroups({textSearch:A}).then((function(e){D(e)})):$()}),[A,$]);var ee,te=function e(t){var n,c=t.level%6,a=w[c];return Object(E.jsx)(N,{ContentProps:{avatarColor:a,onChange:function(e){return function(e,t){if(e.target.checked){var n=t.id,c=t.name;W(n),Y({id:n,name:c})}}(e,t)},onAddClick:function(){return function(e){console.log(e),r(e.id),X(!0)}(t)},showRadio:!0},checked:B===t.id,onClick:function(){return function(e){W(e.id)}(t)},nodeId:t.id,label:t.name,children:null===(n=t.child)||void 0===n?void 0:n.map((function(t){return e(t)}))},t.id)};return Object(E.jsxs)(l.a,{sx:{height:1,display:"flex",flexDirection:"column"},children:[Object(E.jsxs)(l.a,{className:"flex-start flex-wrap",children:[Object(E.jsx)(s.a,{sx:{mr:4},children:Object(j.b)("regTemp.linkGroupToTemp")}),Object(E.jsx)(v.a,{value:A,placeholder:"device.searchGroup",onChange:function(e){F(e)}})]}),Object(E.jsx)(u.a,{sx:{my:3}}),Object(E.jsxs)(l.a,{className:"flex-start flex-wrap",sx:{flex:1,alignItems:"flex-start",overflowY:"auto",minHeight:10},children:[Object(E.jsx)(l.a,{sx:{height:1,width:500,overflowY:"auto"},children:Object(E.jsxs)(k,{selected:B,defaultExpanded:R,defaultCollapseIcon:Object(E.jsx)(g.a,{icon:"ic_arrow_down"}),defaultExpandIcon:Object(E.jsx)(g.a,{icon:"ic_arrow_right"}),sx:{flexGrow:1,overflowY:"auto"},children:[G&&(ee=G,ee.map((function(e){return te(e)}))),!G.length&&Object(E.jsx)(h.a,{})]})}),Object(E.jsx)(u.a,{orientation:"vertical"}),Object(E.jsxs)(l.a,{sx:{flex:1,minWidth:400,p:4,pt:1},children:[Object(E.jsx)(s.a,{children:Object(j.b)("regTemp.selectedGroup")}),U&&Object(E.jsxs)(l.a,{className:"flex-between",style:Object(a.a)({},S),sx:{boxSizing:"border-box",my:3},children:[Object(E.jsx)(g.a,{primary:!0,fontSize:32,icon:"ic_menu_device1"}),Object(E.jsx)(s.a,{component:"div",children:U.name}),Object(E.jsx)(l.a,{sx:{flex:1}}),Object(E.jsx)(d.a,{checked:!0})]})]})]}),Object(E.jsx)(u.a,{sx:{my:3}}),Object(E.jsx)(l.a,{sx:{pb:3,mb:-1},className:"footer",children:Object(E.jsx)(I.a,{content:"regTemp.selectGroupAddTip"})}),Object(E.jsx)(C.a,{parentId:o,open:Q,onClose:function(){X(!1)},onOk:function(){$()}})]})}));t.c=T},719:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var c=n(6),a=n(0),i=n(250);function o(e){var t=Object(a.useState)(),n=Object(c.a)(t,2),o=n[0],r=n[1],l=Object(a.useState)(!1),s=Object(c.a)(l,2),u=s[0],d=s[1],j=Object(a.useCallback)((function(){d(!0),i.f.getAllDevicesWithGroupInfo(e).then((function(e){d(!1),r(e)})).catch((function(){d(!1)}))}),[d,e]);return Object(a.useEffect)((function(){j()}),[j]),{fetchDeviceLoading:u,deviceData:o}}},728:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var c,a=n(23),i=n(5),o=n(6),r=n(42),l=n(83),s=n(689),u=n(134),d=n(655),j=n(354),b=n(37),f=n(0),O=n(43),p=n(250),x=n(47),m=n(173),v=n(174),h=n(51),g=n(682),C=n(705),w=n(45),I=n(138),E=n(671),S=n(719),k=n(139),N=n(1);!function(e){e[e.DEVICE=0]="DEVICE",e[e.GROUP=1]="GROUP"}(c||(c={}));var T=Object(f.forwardRef)((function(e,t){var n=Object(O.c)(x.c),T=Object(f.useState)([]),y=Object(o.a)(T,2),G=y[0],D=y[1],_=Object(f.useState)(e.selected||[]),P=Object(o.a)(_,2),A=P[0],F=P[1],V=Object(f.useState)([]),M=Object(o.a)(V,2),R=(M[0],M[1]),z=Object(f.useState)(c.GROUP),L=Object(o.a)(z,2),B=L[0],W=L[1],H=Object(f.useState)(""),q=Object(o.a)(H,2),U=q[0],Y=q[1],J=Object(f.useState)(new I.d(0,8,null,E.a.BY_CREATED_TIME)),K=Object(o.a)(J,2),Q=K[0],X=K[1],Z=Object(S.a)(Q),$=Z.deviceData,ee=Z.fetchDeviceLoading,te=Object(f.useState)(""),ne=Object(o.a)(te,2),ce=ne[0],ae=ne[1];Object(f.useEffect)((function(){F(e.selected||[])}),[e.selected]);var ie=Object(f.useCallback)((function(){Promise.resolve().then((function(){e.onChange&&e.onChange()}))}),[e]),oe=Object(f.useCallback)((function(){p.f.getAllGroupTree().then((function(e){e.success&&D(e.nodeList),ae(e.nodeList[0].id)}))}),[]),re=Object(f.useCallback)((function(){p.f.getAllGroups().then((function(e){return R(e)}))}),[]);Object(f.useEffect)((function(){re()}),[re]),Object(f.useImperativeHandle)(t,(function(){return{getSelected:function(){return A},getDevicesAndGroupIds:function(){var e=[],t=[];return null===A||void 0===A||A.forEach((function(n){n.type===c.DEVICE?e.push(n.id):t.push(n.id)})),{deviceIdList:e,deviceGroupIdList:t}}}})),Object(f.useEffect)((function(){U?p.f.searchGroups({textSearch:U}).then((function(e){D(e)})):oe()}),[U,oe]);var le,se=B===c.DEVICE,ue=function(e){W(e)},de=Object(f.useCallback)((function(e){return A.some((function(t){return t.id===e}))}),[A]),je=Object(f.useCallback)((function(e){de(e.id)?F(A.filter((function(t){return t.id!==e.id}))):F([].concat(Object(a.a)(A),[{name:e.name||e.friendlyName,id:e.id,type:B}])),ie()}),[de,ie,A,B]),be=Object(f.useCallback)((function(e){var t="ic_add2",n=null,c="common.add";return de(e.id)&&(t="ic_failed",n="red",c="common.remove"),Object(N.jsxs)(r.a,{onClick:function(){return je(e)},className:"flex-start pointer",sx:{flexWrap:"nowrap"},children:[Object(N.jsx)(h.a,{primary:!0,color:n,icon:t}),Object(N.jsx)(l.a,{sx:{whiteSpace:"nowrap"},children:Object(b.b)(c)})]},0)}),[de,je]),fe=Object(f.useCallback)((function(e){var t,c=e.level%6,a=n[c];return Object(N.jsx)(C.a,{ContentProps:{avatarColor:a,showAddButton:!1,operationComponents:[be(e)]},nodeId:e.id,label:e.name,children:null===(t=e.child)||void 0===t?void 0:t.map((function(e){return fe(e)}))},e.id)}),[n,be]),Oe=Object(f.useMemo)((function(){return[new w.a("friendlyName","file.deviceName"),new w.a("groupName","file.linkedGroup"),new w.d("operation",null,"right",130,(function(e){return be(e)}))]}),[be]);return Object(N.jsx)(f.Fragment,{children:Object(N.jsxs)(r.a,{sx:{py:1,pt:3,alignItems:"flex-start",width:1140},className:"flex",children:[Object(N.jsxs)(r.a,{sx:{width:560},children:[Object(N.jsxs)(r.a,{className:"flex-between",sx:{pl:6},children:[Object(N.jsxs)(r.a,{children:[Object(N.jsx)(m.a,{fullWidth:!0,sx:{display:se?"block":"none"},value:Q.textSearch,placeholder:"device.searchDevice",onChange:function(e){X(Object(i.a)(Object(i.a)({},Q),{},{textSearch:e,page:0}))}}),Object(N.jsx)(m.a,{fullWidth:!0,sx:{display:se?"none":"block"},value:U,placeholder:"device.searchGroup",onChange:function(e){Y(e)}})]}),Object(N.jsxs)(s.a,{sx:{ml:2},variant:"contained","aria-label":"outlined primary button group",children:[Object(N.jsx)(u.a,{variant:se?"text":"contained",onClick:function(){return ue(c.GROUP)},children:Object(b.b)("device.deviceGroup")}),Object(N.jsx)(u.a,{variant:se?"contained":"text",onClick:function(){return ue(c.DEVICE)},children:Object(b.b)("file.device")})]})]}),Object(N.jsxs)(r.a,{sx:{px:2,mt:2,height:480,overflow:"auto",borderRight:"1px solid #eee"},children:[ce&&Object(N.jsxs)(C.b,{defaultExpanded:[ce],defaultCollapseIcon:Object(N.jsx)(h.a,{icon:"ic_arrow_down"}),defaultExpandIcon:Object(N.jsx)(h.a,{icon:"ic_arrow_right"}),sx:{flexGrow:1,overflowY:"auto",display:se?"none":""},children:[G&&(le=G,le.map((function(e){return fe(e)}))),!G.length&&Object(N.jsx)(v.a,{})]}),!ce&&Object(N.jsx)(k.a,{size:"small",title:null}),Object(N.jsx)(r.a,{sx:{display:se?"":"none",height:1},children:Object(N.jsx)(w.g,{hideBoxShadow:!0,loading:ee,rows:null===$||void 0===$?void 0:$.data,totalPages:null===$||void 0===$?void 0:$.totalPages,columns:Oe,pageSize:8,page:Q.page,pageChange:function(e){X(Object(i.a)(Object(i.a)({},Q),{},{page:e}))}})})]})]}),Object(N.jsxs)(r.a,{sx:{flex:1,px:6,width:520},children:[Object(N.jsxs)(r.a,{className:"flex-between",children:[Object(N.jsx)(l.a,{children:Object(b.b)("file.selectedDevicesOrGroup")}),Object(N.jsx)(u.a,{onClick:function(){ie(),F([])},variant:"text",children:Object(b.b)("file.removeAll")})]}),Object(N.jsx)(r.a,{sx:{pt:4,height:460,overflowY:"auto"},children:Object(N.jsx)(d.a,{rowSpacing:2,container:!0,children:A.map((function(e){return Object(N.jsx)(d.a,{item:!0,xs:6,children:Object(N.jsx)(g.a,{sx:{mr:2,maxWidth:210},deleteIcon:Object(N.jsx)(j.a,{sx:{ml:1,mr:"0 !important"},children:Object(N.jsx)(h.a,{mr:0,pointer:!0,fontSize:12,icon:"ic_dialog_close"})}),onDelete:function(){return t=e.id,ie(),void F(A.filter((function(e){return e.id!==t})));var t},label:e.name})},e.id)}))})})]})]})})}));t.b=T},991:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return K}));var c=n(6),a=n(42),i=n(968),o=n(997),r=n(0),l=n(171),s=n(26),u=n(738),d=n(139),j=n(5),b=n(83),f=n(655),O=n(217),p=n(64),x=n(259),m=n(43),v=n(718),h=n(78),g=n(47),C=n(24),w=n(251),I=n(682),E=n(175),S=n(51),k=n(138),N=n(885),T=n(1),y={xs:12,lg:6,xl:4},G=Object(O.a)((function(){return{container:{position:"relative","&:hover":{"& .icon-container":{}}},icon:{position:"absolute",right:8,top:8,zIndex:401,cursor:"pointer"}}})),D=new Map([]),_=k.c;function P(e){var t,n=Object(m.c)(g.l),i=Object(r.useState)(new k.d(0,_)),o=Object(c.a)(i,1)[0],s=Object(r.useState)([]),d=Object(c.a)(s,2),O=d[0],P=d[1],A=e.detail,F=e.detail,V=F.id,M=F.latitude,R=F.longitude,z=F.radius,L=V+"map-view",B=Object(r.useMemo)((function(){return[M,R]}),[M,R]),W=Object(v.a)({id:L,center:B,zoom:Object(N.b)(z)+2}),H=W.map,q=W.clustMarker,U=Object(l.a)().t,Y=G();Object(r.useEffect)((function(){u.a.getDeviceLocationsOfGeofence(V,o).then((function(e){P(e.content)}))}),[o,V]),Object(r.useEffect)((function(){H&&Object(x.circle)(B,{fillColor:n,radius:z,color:n}).addTo(H)}),[H,B,z,n,null===(t=A.additionalInfo)||void 0===t?void 0:t.placeName]);var J=Object(r.useCallback)((function(e){if(!e)return U("no data");var t=e.deviceName,n=e.status,c=e.model,a=e.actionCode,i=[{label:U("device.deviceName"),value:t},{label:U("device.model"),value:c},{label:U("geofence.lastAction"),value:U("geofence.actionType."+a)},{label:U("geofence.lastActionStatus"),value:U("device.taskStatus."+h.o.get(n))}].map((function(e){return'<div class="flex-start device-location-detail-geofencing-popup"><span class="geo-detail-title">'.concat(e.label,": </span>\n<span>").concat(e.value,"</span></div>\n")})).join("");return"<div>\n".concat(i,"\n</div>\n")}),[U]),K=Object(r.useCallback)((function(e,t){var n=e.deviceId,c=D.get(n);c?t.setPopupContent(J(c)):(t.setPopupContent("loading...").openPopup(),u.a.getDeviceGeofenceDetail(n).then((function(e){var c=J(e);t.setPopupContent(c),D.set(n,e)})))}),[J]);Object(r.useEffect)((function(){if(H){console.log(O);var e=O.map((function(e){var t=e.latitude,n=e.longitude,c=Object(x.marker)([t,n],{icon:C.t});return c.bindPopup(null),c.on("click",(function(){K(e,c)})),c}));q(e)}}),[H,O,q,K]);var Q=Object(r.useMemo)((function(){var e,t=A.operation,n=t.lockDevice,c=t.alarm,a=Object(T.jsxs)(r.Fragment,{children:[n&&Object(T.jsx)(I.a,{sx:{pr:0,mr:1,bgcolor:function(e){return Object(p.a)(e.palette.info.main,.08)},color:function(e){return e.palette.info.main}},label:U("geofence.lockDevice"),size:"small"}),c&&Object(T.jsx)(I.a,{sx:{pr:0,mr:1,bgcolor:function(e){return Object(p.a)(e.palette.warning.main,.08)},color:function(e){return e.palette.warning.main}},label:U("geofence.alarm"),size:"small"})]});return[{key:"radius",render:Object(T.jsx)(b.a,{children:U("geofence.cardDisplay.radiusUnit",{data:A.radius})})},{key:"latitude",render:Object(T.jsx)(b.a,{children:A.latitude.toFixed(7)})},{key:"longitude",render:Object(T.jsx)(b.a,{children:A.longitude.toFixed(7)})},{key:"description",render:Object(T.jsx)(b.a,{children:A.description||"-"})},{key:"address",render:Object(T.jsx)(b.a,{children:(null===(e=A.additionalInfo)||void 0===e?void 0:e.placeName)||"-"})},{key:"command",render:a}]}),[A,U]);return Object(T.jsx)(E.a,{fullHeight:!0,title:null===A||void 0===A?void 0:A.name,children:Object(T.jsx)(a.a,{sx:{minHeight:"calc(100% - 16px)",mb:2,alignItems:"flex-start"},className:"flex-between",children:Object(T.jsx)(f.a,{container:!0,spacing:2,columnSpacing:{xs:1,sm:2,lg:3,xl:4},children:Object(T.jsx)(f.a,{item:!0,xs:12,children:Object(T.jsxs)(a.a,{className:Y.container,sx:{border:1,borderColor:w.a,borderRadius:1},children:[Object(T.jsx)(a.a,{sx:{p:.2,bgcolor:"#fff"},className:Y.icon+" icon-container flex",children:Object(T.jsx)(S.a,{icon:"fullscreen",mr:0,onClick:function(){var e;null===(e=document.getElementById(L))||void 0===e||e.requestFullscreen()}})}),Object(T.jsx)(a.a,{id:L,sx:{height:460}}),Object(T.jsx)(a.a,{sx:{p:2},children:Object(T.jsx)(f.a,{container:!0,spacing:2,children:Q.map((function(e){return Object(T.jsxs)(f.a,Object(j.a)(Object(j.a)({item:!0},y),{},{children:[Object(T.jsx)(b.a,{variant:"subtitle1",children:U("geofence."+e.key)}),e.render]}),e.key)}))})})," "]})})})})})}var A=n(134),F=n(250),V=n(104),M=n(36),R=n(105),z=n(45),L=n(679),B=n(728),W=n(135),H=[new M.e(h.i.OPEN_GEOFENCING,"geofence.actionType.OpenGeofencing","erji-wanchengqianyi"),new M.e(h.i.CLOSE_GEOFENCING,"geofence.actionType.CloseGeofencing","erji-quxiaoqianyi")];function q(e){var t=e.detail,n=Object(r.useState)(new k.d(0,6)),i=Object(c.a)(n,2),o=i[0],s=i[1],d=Object(r.useState)(),b=Object(c.a)(d,2),f=b[0],O=b[1],p=Object(r.useState)(!1),x=Object(c.a)(p,2),m=x[0],v=x[1],g=Object(r.useState)(!1),w=Object(c.a)(g,2),I=w[0],S=w[1],N=Object(r.useRef)(),y=Object(V.b)(),G=Object(l.a)().t;Object(r.useEffect)((function(){v(!0),u.a.getDevicesOfGeofence(t.id,o).then((function(e){O(e),v(!1)})).catch((function(){v(!1)}))}),[o,t.id]);var D=Object(r.useCallback)((function(e,n){if(t){var c={latitude:t.latitude,longitude:t.longitude,radius:t.radius,operation:t.operation};new F.b([n.deviceId],h.d.DEVICE,new h.s(e,new h.t("device",n.deviceName,n.deviceId),e,t.name),c,void 0,void 0,t.id).sendCmd().then((function(){s(Object(j.a)(Object(j.a)({},o),{},{page:0}))}))}}),[o,t]),_=Object(r.useMemo)((function(){var e=[new z.f("left","deviceName","device.deviceName"),new z.a("model","device.model"),new z.a("action","geofence.lastAction",void 0,(function(e){return G("geofence.actionType."+e.actionCode)})),new z.d("lastActionStatus","geofence.lastActionStatus",void 0,void 0,(function(e){var t=h.o.get(e.status);return Object(T.jsx)(L.a,{size:"small",sx:{ml:2},color:h.n.get(t),label:G("device.taskStatus."+t)})}))];return y||e.push(new z.d("operation","common.operation","right",100,(function(e){return Object(T.jsx)(a.a,{sx:{px:1},children:Object(T.jsx)(R.a,{sx:{pl:.8},menus:H,onMenuClick:function(t){return D(t,e)}})})}))),e}),[G,D,y]);return Object(T.jsxs)(E.a,{fullHeight:!0,title:null===t||void 0===t?void 0:t.name,headerChild:!y&&Object(T.jsx)(A.a,{onClick:function(){S(!0)},children:G("geofence.addDevice")}),children:[Object(T.jsx)(z.g,{page:o.page,totalPages:null===f||void 0===f?void 0:f.totalPages,rows:null===f||void 0===f?void 0:f.data,columns:_,pageSize:6,hideBoxShadow:!0,loading:m,pageChange:function(e){s(Object(j.a)(Object(j.a)({},o),{},{page:e}))}}),Object(T.jsx)(W.b,{size:"lg",open:I,title:"geofence.addDevice",onOk:function(){var e=N.current.getDevicesAndGroupIds(),n=e.deviceIdList,c=e.deviceGroupIdList;if(n.length||c.length){if(t){var a={latitude:t.latitude,longitude:t.longitude,radius:t.radius,operation:t.operation},i=new F.a(c,n,new h.s(h.i.OPEN_GEOFENCING,new h.t("devices-and-groups",null,null),h.i.OPEN_GEOFENCING,t.name),a,t.id).sendCmd();return i.then((function(){s(Object(j.a)(Object(j.a)({},o),{},{page:0}))})),i}}else C.c.error("geofence.requiredFields.devices")},onClose:function(){S(!1)},children:Object(T.jsx)(B.b,{ref:N})})]})}var U,Y={sm:"12px !important"};!function(e){e[e.MAP_VIEW=0]="MAP_VIEW",e[e.DEVICES=1]="DEVICES"}(U||(U={}));var J=[{label:"geofence.tabs.mapView",tab:U.MAP_VIEW},{label:"geofence.tabs.devices",tab:U.DEVICES}];function K(){var e=Object(s.o)().id,t=Object(l.a)().t,n=Object(r.useState)(U.MAP_VIEW),j=Object(c.a)(n,2),b=j[0],f=j[1],O=Object(r.useState)(),p=Object(c.a)(O,2),x=p[0],m=p[1],v=Object(r.useState)(!0),h=Object(c.a)(v,2),g=h[0],C=h[1];Object(r.useEffect)((function(){u.a.getGeofenceDetail(e).then((function(e){m(e),C(!1)})).catch((function(e){C(!1)}))}),[e]);return g?Object(T.jsx)(d.a,{title:null}):Object(T.jsxs)(a.a,{sx:{px:Y},children:[Object(T.jsx)(a.a,{sx:{mt:-1,mb:2,ml:1},className:"flex-between",children:Object(T.jsx)(i.a,{variant:"scrollable",scrollButtons:"auto",allowScrollButtonsMobile:!0,value:b,onChange:function(e,t){f(t)},"aria-label":"basic tabs example",children:J.map((function(e){return Object(T.jsx)(o.a,{label:t(e.label)},e.tab)}))})}),Object(T.jsx)(a.a,{sx:{height:"calc(100% - 56px)",overflow:"auto"},children:function(){switch(b){case U.MAP_VIEW:return x&&Object(T.jsx)(P,{detail:x});case U.DEVICES:return Object(T.jsx)(q,{detail:x})}}()})]})}}}]);