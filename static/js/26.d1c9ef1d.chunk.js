(this["webpackJsonpui-ngx"]=this["webpackJsonpui-ngx"]||[]).push([[26],{1002:function(e,t,n){"use strict";n.r(t),n.d(t,"AppActions",(function(){return M})),n.d(t,"default",(function(){return F}));var c=n(23),a=n(5),i=n(6),o=n(0),r=n(42),l=n(662),s=n(663),d=n(660),j=n(661),u=n(659),b=n(564),p=n(351),O=n(138),x=n(557),f=n(650),h=n(37),m=n(45),v=n(711),g=n(83),E=n(354),C=n(918),A=n.n(C),S=n(917),D=n.n(S),w=n(36),T=n(105),k=n(24),I=n(104),L=n(317),y=n(1);function B(e){var t,n,c=e.row,a=e.columns,l=e.onMenuClick,s=e.selectChange,j=e.checked,u=Object(o.useState)(!1),b=Object(i.a)(u,2),p=b[0],O=b[1],f=Object(I.a)(),h=Object(o.useMemo)((function(){var e=[new w.e(M.DOWNLOAD,"app.downloadApp","ic_download"),new w.e(M.DELETE,"app.deleteApp","ic_delete")];return f?e:[e[0]]}),[f]),m=c.appList[0];return Object(y.jsxs)(o.Fragment,{children:[Object(y.jsxs)(L.a,{selected:j,children:[f&&Object(y.jsx)(d.a,{sx:{borderBottom:"none"},onClick:function(e){return s(e,c)},padding:"checkbox",children:Object(y.jsx)(x.a,{color:"primary",checked:j})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},component:"th",scope:"row",children:Object(y.jsxs)(r.a,{className:"flex-start",sx:{flexWrap:"nowrap"},children:[Object(y.jsx)(v.a,{sx:{mr:2},variant:"rounded",src:null===c||void 0===c?void 0:c.appList[0].iconPathHttps}),Object(y.jsx)(g.a,{children:c.name})]})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:(null===(t=c.appList)||void 0===t?void 0:t.length)>1&&Object(y.jsx)(E.a,{"aria-label":"expand row",size:"small",onClick:function(){return O(!p)},children:p?Object(y.jsx)(D.a,{}):Object(y.jsx)(A.a,{})})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:null===m||void 0===m?void 0:m.versionName})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:Object(k.n)(null===m||void 0===m?void 0:m.fileSize)})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:null===m||void 0===m?void 0:m.versionCode})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:null===m||void 0===m?void 0:m.minSdkVersion})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:null===m||void 0===m?void 0:m.identifier})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:Object(k.y)(null===m||void 0===m?void 0:m.createdTime)})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(T.a,{menus:h,onMenuClick:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return l(e,m,c)}))})})]}),null===(n=c.appList)||void 0===n?void 0:n.slice(1,c.appList.length).map((function(e){return Object(y.jsx)(L.a,{selected:j,children:p&&Object(y.jsxs)(o.Fragment,{children:[f&&Object(y.jsx)(d.a,{sx:{borderBottom:"none"},component:"th",scope:"row"}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"}}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"}}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:e.versionName})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:Object(k.n)(e.fileSize)})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:e.versionCode})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:e.minSdkVersion})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:e.identifier})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(g.a,{children:Object(k.y)(e.createdTime)})}),Object(y.jsx)(d.a,{sx:{borderBottom:"none"},children:Object(y.jsx)(T.a,{menus:h,onMenuClick:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t){return l(t,e,c)}))})})]})},e.versionCode+e.versionName)})),Object(y.jsxs)(L.a,{selected:j,sx:{borderBottom:"1px solid rgba(224, 224, 224, 1)"},children:[Object(y.jsx)(d.a,{sx:{p:0},component:"th",scope:"row"}),a.map((function(e){return Object(y.jsx)(d.a,{sx:{p:0}},e.key)}))]})]})}var M,N=n(671),_=n(174),P=n(258),z=n(691),U=n(818);!function(e){e[e.DOWNLOAD=0]="DOWNLOAD",e[e.DELETE=1]="DELETE"}(M||(M={}));function F(){var e=Object(o.useState)(),t=Object(i.a)(e,2),n=t[0],v=t[1],g=Object(o.useState)(N.a.BY_CREATED_TIME),E=Object(i.a)(g,2),C=E[0],A=E[1],S=Object(o.useState)(new O.d(0,8,void 0,N.a.BY_CREATED_TIME)),D=Object(i.a)(S,2),w=D[0],T=D[1],L=Object(o.useState)([]),F=Object(i.a)(L,2),R=F[0],G=F[1],V=Object(o.useState)(!0),Y=Object(i.a)(V,2),H=Y[0],X=Y[1],W=Object(o.useState)(!1),J=Object(i.a)(W,2),q=J[0],K=J[1],Q=Object(I.a)(),Z=Object(o.useCallback)((function(){X(!0),z.a.getAppList(new O.d(0,8,void 0,N.a.BY_CREATED_TIME)).then((function(e){v(e),X(!1)})).catch((function(){X(!1)}))}),[]);Object(o.useEffect)((function(){Z()}),[Z]);var $=Object(o.useCallback)((function(){return w.sortProperty===N.a.BY_CREATED_TIME?function(e,t){return t.appList[0].createdTime-e.appList[0].createdTime}:function(e,t){return e.appList[0].name.localeCompare(t.appList[0].name)}}),[w.sortProperty]),ee=Object(o.useMemo)((function(){return((null===n||void 0===n?void 0:n.data.sort($()))||[]).filter((function(e){var t;return e.name.toLowerCase().includes((null===(t=w.textSearch)||void 0===t?void 0:t.toLowerCase())||"")}))}),[w.textSearch,n,$]),te=Object(o.useMemo)((function(){if(null===n||void 0===n||!n.data)return[];var e=w.page,t=w.pageSize;return ee.slice(e*t,(e+1)*t)}),[w,n,ee]),ne=Object(o.useMemo)((function(){return te.map((function(e){return e.identifier}))}),[te]),ce=Math.ceil(ee.length/8),ae=R.map((function(e){return e.identifier})),ie=R.length,oe=function(e,t,c){switch(e){case M.DOWNLOAD:Object(k.l)(t.filePathHttps);break;case M.DELETE:Object(k.a)({title:Object(h.b)("app.deleteTitle",{name:c.name}),content:"common.deleteContent",okText:"common.delete",okBtnColor:"error",onOk:function(){var e=z.a.deleteApp(t.id);return e.then((function(e){c.appList.length>1?v(Object(a.a)(Object(a.a)({},n),{},{data:(null===n||void 0===n?void 0:n.data.map((function(e){return e.identifier!==t.identifier?e:Object(a.a)(Object(a.a)({},e),{},{appList:e.appList.filter((function(e){return e.id!==t.id}))})})))||[]})):(T(Object(a.a)(Object(a.a)({},w),{},{page:0})),v(Object(a.a)(Object(a.a)({},n),{},{data:(null===n||void 0===n?void 0:n.data.filter((function(e){return e.identifier!==t.identifier})))||[]})))})).catch(re),e}})}},re=function(e){var t;161===(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.errorCode)&&k.c.error(Object(h.b)("app.deleteError",{name:e.data.message}))},le=ae.length<=0,se=function(e,t){e.target.checked?ae.includes(t.identifier)||G([].concat(Object(c.a)(R),[t])):G(R.filter((function(e){return e.identifier!==t.identifier})))},de=ne.length>0&&ne.every((function(e){return ae.includes(e)})),je=!de&&R.some((function(e){return ne.includes(e.identifier)})),ue=Object(o.useMemo)((function(){var e=[new m.a("name","app.appName"),new m.a("",null),new m.a("versionName","app.version"),new m.a("fileSize","app.appSize"),new m.a("versionCode","app.internalVersion"),new m.a("minSdkVersion","app.compatibility"),new m.a("identifier","app.packageName"),new m.a("createdTime","app.createdTime")];return e.push(new m.d("operation","")),e}),[]);return Object(y.jsxs)(r.a,{sx:{height:1},className:"content-container",children:[Object(y.jsx)(N.b,{sortProp:C,onSortChange:function(e){A(e),e!==w.sortProperty&&T(Object(a.a)(Object(a.a)({},w),{},{sortProperty:e,page:0}))},textSearch:w.textSearch,onSearchChange:function(e){T(Object(a.a)(Object(a.a)({},w),{},{page:0,textSearch:e}))},deleteDisabled:le,onAdd:function(){K(!0)},onDelete:Q?function(){Object(k.a)({title:Object(h.b)("app.multiDeleteTitle",{count:ie}),content:"common.deleteContent",okText:"common.delete",okBtnColor:"error",onOk:function(){var e=z.a.deleteByIdentifiers(R.map((function(e){return e.identifier})));return e.then((function(){G([]),T(Object(a.a)(Object(a.a)({},w),{},{page:0})),v(Object(a.a)(Object(a.a)({},n),{},{data:null===n||void 0===n?void 0:n.data.filter((function(e){return!ae.includes(e.identifier)}))}))})).catch(re),e}})}:null,deleteTitle:"app.deleteApp",addTitle:"app.uploadApp"}),Object(y.jsxs)(p.a,{sx:{height:"calc(100% - 56px)",position:"relative",boxShadow:k.g,overflow:"hidden"},children:[Object(y.jsxs)(j.a,{sx:{maxHeight:"calc(100% - 68px)",height:1},children:[Object(y.jsxs)(l.a,{stickyHeader:!0,"aria-label":"collapsible table",children:[te.length>=0&&Object(y.jsx)(u.a,{children:Object(y.jsxs)(b.a,{children:[Q&&Object(y.jsx)(d.a,{padding:"checkbox",children:Object(y.jsx)(x.a,{color:"primary",indeterminate:je,checked:de,onChange:function(e){if(e.target.checked){var t=Object(c.a)(R);return te.forEach((function(e){t.some((function(t){return t.identifier===e.identifier}))||t.push(e)})),void G(t)}var n=R.filter((function(e){return!ne.includes(e.identifier)}));G(n)},inputProps:{"aria-label":"select all desserts"}})}),ue.map((function(e,t){return Object(y.jsx)(d.a,{sx:{color:"#0000008c"},children:Object(h.b)(e.title)},e.key+t)}))]})}),Object(y.jsx)(s.a,{children:te.map((function(e){return Object(y.jsx)(B,{checked:ae.includes(e.identifier),selectChange:se,onMenuClick:oe,columns:ue,row:e},e.name)}))})]}),!te.length&&!H&&Object(y.jsx)(_.a,{emptyTitle:"app.emptyTitle",type:"application"})]}),Object(y.jsx)(r.a,{sx:{p:1.5,py:2,pr:0,opacity:te.length?1:0},children:Object(y.jsx)(f.a,{sx:{display:"flex",justifyContent:"flex-end"},color:"primary",count:ce,onChange:function(e,t){T(Object(a.a)(Object(a.a)({},w),{},{page:t-1}))},page:w.page+1})}),H&&Object(y.jsx)(P.a,{})]}),Object(y.jsx)(U.a,{open:q,onOk:function(){T(Object(a.a)(Object(a.a)({},w),{},{page:0})),Z()},onClose:function(){K(!1)}})]})}},671:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return S}));var c,a=n(42),i=n(83),o=n(134),r=n(354),l=n(674),s=n.n(l),d=n(673),j=n.n(d),u=n(43),b=n(36),p=n(47),O=n(173),x=n(155),f=n(37),h=n(672),m=n(106),v=n(251),g=n(104),E=n(0),C=n(1);!function(e){e.BY_TITLE="name",e.BY_CREATED_TIME="createdTime"}(c||(c={}));var A=[new b.e(c.BY_TITLE,"regTemp.sortBy.name"),new b.e(c.BY_CREATED_TIME,"regTemp.sortBy.createdTime")];function S(e){var t=e.sortProp,n=e.onSortChange,c=e.textSearch,l=e.onSearchChange,d=e.deleteDisabled,b=e.deleteTitle,S=e.addTitle,D=e.selectTitle,w=e.showSelectBtn,T=void 0!==w&&w,k=e.selectMode,I=void 0!==k&&k,L=e.authControl,y=void 0===L?"GENERAL":L,B=e.menus||A,M=Object(g.b)(),N=Object(g.a)(),_="GENERAL"===y?N:!M,P=Object(u.c)(p.a),z={add:!T||!I,delete:(!T||I)&&e.onDelete,select:T&&!I,selectAll:T&&I&&e.viewMode===h.a.CARD,cancel:T&&I};return Object(C.jsxs)(a.a,{sx:{mb:2,display:"flex",justifyContent:"space-between",height:36},children:[I&&Object(C.jsxs)(a.a,{className:"flex-start",children:[Object(C.jsx)(i.a,{fontSize:16,color:v.c,children:e.selectedCount}),Object(C.jsx)(i.a,{sx:{ml:1},children:Object(f.b)("common.selected")})]}),!I&&Object(C.jsxs)(a.a,{className:"flex-start",children:[void 0!==e.viewMode&&Object(C.jsx)(h.b,{items:h.c,mode:e.viewMode,onChange:e.onViewModeChange}),P?null:Object(C.jsx)(x.a,{title:"regTemp.sortBy."+t,selected:t,menus:B,onMenuClick:n}),Object(C.jsx)(O.a,{sx:{ml:P?0:2,bgcolor:"#fff"},value:c,onChange:l})]}),_&&Object(C.jsx)(E.Fragment,{children:P?Object(C.jsxs)(a.a,{children:[Object(C.jsx)(r.a,{onClick:e.onAdd,size:"medium",edge:"start",color:"primary","aria-label":"open drawer",sx:{mr:1},children:Object(C.jsx)(j.a,{})}),Object(C.jsx)(r.a,{onClick:e.onDelete,disabled:d,size:"medium",edge:"start",color:"error","aria-label":"open drawer",children:Object(C.jsx)(s.a,{})})]}):Object(C.jsxs)(a.a,{children:[z.add&&Object(C.jsx)(o.a,{onClick:e.onAdd,variant:"contained",children:Object(f.b)(S)}),z.cancel&&Object(C.jsx)(o.a,{onClick:function(){e.selectAll(!1),e.setSelectMode(!1)},variant:"outlined",children:Object(f.b)("common.cancel")}),z.selectAll&&Object(C.jsx)(m.a,{sx:{ml:2},onClick:function(){e.selectAll&&e.selectAll(!0)},children:Object(f.b)("common.selectAll")}),z.select&&Object(C.jsx)(m.a,{sx:{ml:2},onClick:function(){var t;void 0!==t?e.setSelectMode(t):e.setSelectMode(!I)},children:Object(f.b)(D)}),z.delete&&Object(C.jsx)(o.a,{onClick:e.onDelete,disabled:d,sx:{ml:2},variant:void 0!==e.viewMode?"contained":"outlined",children:Object(f.b)(b)})]})})]})}},672:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return O}));var c,a=n(5),i=n(7),o=n(134),r=n(64),l=n(689),s=n(995),d=n(171),j=n(51),u=n(1),b=Object(i.a)(o.a)((function(e){var t=e.theme;return{height:36,borderColor:t.palette.action.disabled,"&:hover":{borderColor:t.palette.action.disabled},"&.checked":{backgroundColor:Object(r.a)(t.palette.primary.main,.32)},"&.checked:hover":{backgroundColor:Object(r.a)(t.palette.primary.main,.32)}}}));!function(e){e[e.LIST=0]="LIST",e[e.CARD=1]="CARD"}(c||(c={}));var p=[{icon:"ic_viewmodule",value:c.CARD,label:"common.cardView"},{icon:"ic_viewheadline",value:c.LIST,label:"common.listView"}];function O(e){var t=e.mode,n=e.onChange,c=e.items,i=void 0===c?[]:c,o=e.sx,r=void 0===o?{}:o,p=Object(d.a)().t;return Object(u.jsx)(l.a,{sx:Object(a.a)({mr:2},r),children:i.map((function(e){return Object(u.jsx)(s.a,{title:p(e.label),children:Object(u.jsx)(b,{size:"small",onClick:function(){var c;(c=e.value)!==t&&n(c)},className:t===e.value?"checked":"",sx:{px:1},children:Object(u.jsx)(j.a,{color:"rgba(0, 0, 0, 0.54)",mr:0,icon:e.icon})})},e.label)}))})}},688:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"g",(function(){return p})),n.d(t,"e",(function(){return j})),n.d(t,"f",(function(){return x})),n.d(t,"c",(function(){return O}));var c,a,i=n(13),o=n(14),r=n(30),l=n(31),s=n(108),d=n(138);!function(e){e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.DOCUMENT="DOCUMENT",e.AUDIO="AUDIO",e.OTHER="OTHER"}(c||(c={})),function(e){e.GENERATE="generate",e.TEMPORARY="temporary"}(a||(a={}));var j,u=function(e){Object(r.a)(n,e);var t=Object(l.a)(n);function n(){var e,c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"desc",s=arguments.length>5?arguments[5]:void 0;return Object(o.a)(this,n),(e=t.call(this,c,a,i,r,l)).page=c,e.pageSize=a,e.textSearch=i,e.sortProperty=r,e.sortOrder=l,e.fileType=s,e}return Object(i.a)(n)}(d.d),b=new Map([[c.AUDIO,["mp3","aac/mpa","ape/flac","wav","wma","amr","mid"]],[c.VIDEO,["wmv","asf","asx","mp4","mov","m4v","avi","dat","mkv","flv","vob"]],[c.IMAGE,["gif","jpg","pic","png","bmp","tif","svg"]],[c.DOCUMENT,["txt","doc","wps","docx","xls","xlsx","pdf","ppt","pptx","md"]]]);function p(e){var t,n=e.split("."),a=n[n.length-1];return t=a,[c.AUDIO,c.VIDEO,c.IMAGE,c.DOCUMENT].find((function(e){return b.get(e).includes(t)}))||c.OTHER}!function(e){e[e.UPLOADING=0]="UPLOADING",e[e.FILE_EXISTED=1]="FILE_EXISTED",e[e.FAILED=2]="FAILED",e[e.SUCCESSED=3]="SUCCESSED",e[e.CANCELED=4]="CANCELED"}(j||(j={}));var O,x=Object(i.a)((function e(t,n){var c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j.UPLOADING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Object(s.a)(),i=arguments.length>4?arguments[4]:void 0;Object(o.a)(this,e),this.name=t,this.size=n,this.status=c,this.id=a,this.version=i}));!function(e){e[e.NAME_EXISTED=48]="NAME_EXISTED"}(O||(O={}))},691:function(e,t,n){"use strict";var c=n(13),a=n(14),i=n(18),o=n(30),r=n(31),l=n(17),s=n(12),d=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(){var e,c,o,r,d;Object(a.a)(this,n);for(var j=arguments.length,u=new Array(j),b=0;b<j;b++)u[b]=arguments[b];return(d=t.call.apply(t,[this].concat(u))).getAppList=function(t){return Object(l.a)((e=Object(i.a)(d),Object(s.a)(n.prototype)),"get",e).call(e,"/api/apps",{params:t,timeout:12e4})},d.deleteByIdentifier=function(e){return Object(l.a)((c=Object(i.a)(d),Object(s.a)(n.prototype)),"delete",c).call(c,"/api/deleteByIdentifier?identifier="+e)},d.deleteByIdentifiers=function(e){return Promise.all(e.map((function(e){return d.deleteByIdentifier(e)})))},d.deleteApp=function(e){return Object(l.a)((o=Object(i.a)(d),Object(s.a)(n.prototype)),"delete",o).call(o,"/api/apps?appIdStr=".concat(e))},d.uploadAppPackage=function(e,t,c){return Object(l.a)((r=Object(i.a)(d),Object(s.a)(n.prototype)),"post",r).call(r,"/api/app",e,{onUploadProgress:t,timeout:1/0,signal:c})},d}return Object(c.a)(n)}(n(107).a),j=new d;t.a=j},727:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var c=n(42),a=n(792),i=n(83),o=n(251),r=n(1);function l(e){var t=(e.progress||0).toFixed(2),n=e.height,l=void 0===n?8:n,s=e.color,d=void 0===s?"primary":s,j=e.label,u=e.sx,b=void 0===u?{}:u,p=t+"%";return Object(r.jsxs)(c.a,{sx:b,className:"flex-start",children:[Object(r.jsx)(c.a,{sx:{flex:1},children:Object(r.jsx)(a.a,{color:d,sx:{height:l,borderRadius:"5px",mr:1},variant:"determinate",value:e.progress})}),Object(r.jsx)(i.a,{color:o.b,children:j||p})]})}},818:function(e,t,n){"use strict";n.d(t,"a",(function(){return A}));var c=n(5),a=n(23),i=n(6),o=n(42),r=n(354),l=n(83),s=n(64),d=n(550),j=n(0),u=n(45),b=n(135),p=n(261),O=n(108),x=n(51),f=n(727),h=n(24),m=n(688),v=n(253),g=n(691),E=n(171),C=n(1);function A(e){var t=Object(j.useState)([]),n=Object(i.a)(t,2),A=n[0],S=n[1],D=Object(j.useState)(new Map([])),w=Object(i.a)(D,2),T=w[0],k=w[1],I=Object(j.useState)(new Map([])),L=Object(i.a)(I,2),y=L[0],B=L[1],M=Object(E.a)().t,N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.e.UPLOADING,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3?arguments[3]:void 0;k((function(a){var i,o=c||(null===(i=a.get(e))||void 0===i?void 0:i.abortController);return a.set(e,{status:t,progress:n,abortController:o}),new Map(a)}))},_=function(t){var n=t[0],c=n.name,i=n.size,o=c+Object(O.a)(),r=new FormData,l=new AbortController;r.append("file",t[0]),r.append("description",null),g.a.uploadAppPackage(r,(function(e){return function(e,t,n){var c=e.loaded,a=e.total,i=parseFloat((100*c/a).toFixed(2));i>=100&&(i=99.99),N(t,m.e.UPLOADING,i,n)}(e,o,l)}),l.signal).then((function(t){N(o,m.e.SUCCESSED,100),y.set(o,t.versionName),B(new Map(y)),h.c.success("file.uploadSuccessed"),e.onOk&&e.onOk()})).catch((function(e){var t;"canceled"!==(null===e||void 0===e?void 0:e.message)?(h.c.error("file.uploadFailed"),(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.errorCode)===m.c.NAME_EXISTED?N(o,m.e.FILE_EXISTED):N(o,m.e.FAILED)):N(o,m.e.CANCELED)})),N(o,void 0,0),S([new m.f(c,i,m.e.UPLOADING,o)].concat(Object(a.a)(A)))},P=Object(j.useCallback)((function(e){var t=e.id,n=T.get(t);(null===n||void 0===n?void 0:n.abortController).abort(),N(t,m.e.CANCELED)}),[T]),z=Object(j.useCallback)((function(e){var t=T.get(e.id),n=t.status,c=t.progress;return n===m.e.UPLOADING?Object(C.jsxs)(o.a,{className:"flex-between",children:[Object(C.jsx)(f.a,{sx:{mr:1,flex:1},progress:c}),Object(C.jsx)(r.a,{size:"small",onClick:function(){return P(e)},children:Object(C.jsx)(x.a,{fontSize:16,icon:"ic_failed",mr:0})})]}):n===m.e.SUCCESSED?Object(C.jsxs)(o.a,{className:"flex-start",children:[Object(C.jsx)(x.a,{fontSize:20,color:"#4CAF50",icon:"ic_success"}),Object(C.jsx)(l.a,{sx:{ml:1},children:M("file.uploadSuccessed")})]}):Object(C.jsxs)(o.a,{className:"flex-start",children:[Object(C.jsx)(x.a,{fontSize:20,color:"#f44336",icon:"ic_failed"}),n===m.e.FILE_EXISTED&&Object(C.jsx)(l.a,{sx:{ml:1},children:M("file.nameExisted")}),n===m.e.FAILED&&Object(C.jsx)(l.a,{sx:{ml:1},children:M("file.uploadError")}),n===m.e.CANCELED&&Object(C.jsx)(l.a,{sx:{ml:1},children:M("file.uploadCanceled")})]})}),[T,M,P]),U=Object(j.useMemo)((function(){return[new u.a("name","app.appName",230),new u.a("version","app.version",120,(function(e){return y.get(e.id)})),new u.a("size","app.appSize",100,(function(e){return Object(h.e)(e.size)})),new u.d("status","common.status",void 0,240,(function(e){return Object(C.jsx)(o.a,{sx:{pl:2},children:z(e)})}))]}),[z,y]);return Object(C.jsx)(b.b,Object(c.a)(Object(c.a)({size:"md",title:"app.uploadApp"},e),{},{okBtnProps:null,cancelBtnProps:{text:"common.close",variant:"contained"},footerPadding:2,children:Object(C.jsxs)(o.a,{sx:{position:"relative"},children:[Object(C.jsx)(u.g,{width:700,hideBoxShadow:!0,pageSize:5,columns:U,rows:A,children:Object(C.jsxs)(o.a,{sx:{height:248,bgcolor:function(e){return Object(s.a)(e.palette.primary.main,.08)}},className:"flex flex-column",children:[Object(C.jsx)(x.a,{icon:"ic_upload_purple",primary:!0}),Object(C.jsx)(l.a,{variant:"subtitle1",sx:{mt:1,mb:3},children:M("app.uploadBtnTip")}),Object(C.jsx)(p.a,{variant:"contained",accept:".apk",onFileChange:_,children:M("app.selectApk")})]})}),Object(C.jsx)(o.a,{sx:{position:"absolute",bottom:16,color:function(e){return e.palette.primary.main}},children:A.length>0?Object(C.jsx)(p.a,{sx:{ml:2},variant:"text",accept:".apk",onFileChange:_,children:M("file.continueUpload")}):Object(C.jsx)(v.a,{content:"app.uploadTip"})}),Object(C.jsx)(d.a,{sx:{my:1,position:"absolute",bottom:-8,width:1}})]})}))}}}]);